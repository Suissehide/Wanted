var EndGate,__extends=this.__extends||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i},eg=EndGate,GameRunnerInstance=(Number.prototype.Clone=function(){return this},!function(e){function i(e,t,n){void 0===t&&(t=0),void 0===n&&(n=0),this._type="TimeSpan",this.Milliseconds=e+t*i._secondsMultiplier+n*i._minutesMultiplier}Object.defineProperty(i.prototype,"Milliseconds",{get:function(){return this._milliseconds},set:function(e){this._milliseconds=e,this._seconds=e/i._secondsMultiplier,this._minutes=e/i._minutesMultiplier},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Seconds",{get:function(){return this._seconds},set:function(e){this._seconds=e,this._milliseconds=e*i._secondsMultiplier,this._minutes=this._milliseconds/i._minutesMultiplier},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Minutes",{get:function(){return this._minutes},set:function(e){this._minutes=e,this._seconds=60*e,this._milliseconds=this._seconds*i._secondsMultiplier},enumerable:!0,configurable:!0}),i.prototype.Add=function(e){return"TimeSpan"===e._type?new i(this.Milliseconds+e.Milliseconds):new i(this.Milliseconds+e)},i.prototype.Multiply=function(e){return"TimeSpan"===e._type?new i(this.Milliseconds*e.Milliseconds):new i(this.Milliseconds*e)},i.prototype.Subtract=function(e){return"TimeSpan"===e._type?new i(this.Milliseconds-e.Milliseconds):new i(this.Milliseconds-e)},i.prototype.SubtractFrom=function(e){return"TimeSpan"===e._type?new i(e.Milliseconds-this.Milliseconds):new i(e-this.Milliseconds)},i.prototype.Divide=function(e){return"TimeSpan"===e._type?new i(this.Milliseconds/e.Milliseconds):new i(this.Milliseconds/e)},i.prototype.DivideFrom=function(e){return"TimeSpan"===e._type?new i(e.Milliseconds/this.Milliseconds):new i(e/this.Milliseconds)},i.prototype.Equivalent=function(e){return this.Milliseconds===e.Milliseconds},i.prototype.Clone=function(){return new i(this.Milliseconds)},i.prototype.toString=function(){return this.Milliseconds+":"+this.Seconds+":"+this.Minutes},i.FromMilliseconds=function(e){return new i(e)},i.FromSeconds=function(e){return new i(0,e)},i.FromMinutes=function(e){return new i(0,0,e)},i.DateSpan=function(e,t){return new i(t.getTime()-e.getTime())},Object.defineProperty(i,"Zero",{get:function(){return new i(0)},enumerable:!0,configurable:!0}),i._minutesMultiplier=60*(i._secondsMultiplier=1e3),e.TimeSpan=i}(EndGate=EndGate||{}),!function(t){Object.defineProperty(n.prototype,"Elapsed",{get:function(){return this._elapsed},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Now",{get:function(){return this._lastUpdate},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Total",{get:function(){return t.TimeSpan.DateSpan(this._start,new Date)},enumerable:!0,configurable:!0}),n.prototype.Update=function(){var e=new Date;this._elapsed=new t.TimeSpan(e.getTime()-this._lastUpdate.getTime()),this._lastUpdate=e};var e=n;function n(){this._type="GameTime",this._start=this._lastUpdate=new Date,this.Update()}t.GameTime=e}(EndGate=EndGate||{}),!function(e){function t(e,t){this._type="Size2d",this.Width=e||0,this.Height=void 0!==t?t:this.Width}Object.defineProperty(t,"Zero",{get:function(){return new t(0,0)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"One",{get:function(){return new t(1,1)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Radius",{get:function(){return.5*Math.sqrt(this.Width*this.Width+this.Height*this.Height)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"HalfWidth",{get:function(){return this.Width/2},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"HalfHeight",{get:function(){return this.Height/2},enumerable:!0,configurable:!0}),t.prototype.Apply=function(e){this.Width=e(this.Width),this.Height=e(this.Height)},t.prototype.Trigger=function(e){e(this.Width),e(this.Height)},t.prototype.Add=function(e){return"Size2d"===e._type?new t(this.Width+e.Width,this.Height+e.Height):"Vector2d"===e._type?new t(this.Width+e.X,this.Height+e.Y):new t(this.Width+e,this.Height+e)},t.prototype.Multiply=function(e){return"Size2d"===e._type?new t(this.Width*e.Width,this.Height*e.Height):"Vector2d"===e._type?new t(this.Width*e.X,this.Height*e.Y):new t(this.Width*e,this.Height*e)},t.prototype.Subtract=function(e){return"Size2d"===e._type?new t(this.Width-e.Width,this.Height-e.Height):"Vector2d"===e._type?new t(this.Width-e.X,this.Height-e.Y):new t(this.Width-e,this.Height-e)},t.prototype.SubtractFrom=function(e){return"Size2d"===e._type?new t(e.Width-this.Width,e.Height-this.Height):"Vector2d"===e._type?new t(e.X-this.Width,e.Y-this.Height):new t(e-this.Width,e-this.Height)},t.prototype.Divide=function(e){return"Size2d"===e._type?new t(this.Width/e.Width,this.Height/e.Height):"Vector2d"===e._type?new t(this.Width/e.X,this.Height/e.Y):new t(this.Width/e,this.Height/e)},t.prototype.DivideFrom=function(e){return"Size2d"===e._type?new t(e.Width/this.Width,e.Height/this.Height):"Vector2d"===e._type?new t(e.X/this.Width,e.Y/this.Height):new t(e/this.Width,e/this.Height)},t.prototype.Negate=function(){return new t(-1*this.Width,-1*this.Height)},t.prototype.Equivalent=function(e){return this.Width===e.Width&&this.Height===e.Height},t.prototype.Clone=function(){return new t(this.Width,this.Height)},t.prototype.toString=function(){return"("+this.Width+", "+this.Height+")"},e.Size2d=t}(EndGate=EndGate||{}),Math.roundTo=function(e,t){t=Math.pow(10,t);return Math.round(e*t)/t},Math.twoPI=2*Math.PI,!function(e){function o(e,t){this._type="Vector2d",this.X=e||0,this.Y=t||0}Object.defineProperty(o,"Zero",{get:function(){return new o(0,0)},enumerable:!0,configurable:!0}),Object.defineProperty(o,"One",{get:function(){return new o(1,1)},enumerable:!0,configurable:!0}),o.prototype.Reflect=function(e){var e=e.Unit(),t=2*this.Dot(e);return new o(this.X-t*e.X,this.Y-t*e.Y)},o.prototype.ProjectOnto=function(e){return e.Multiply(this.Dot(e)/e.Dot(e))},o.prototype.RotateAround=function(e,t,n){void 0===n&&(n=2);var i=Math.cos(t),t=Math.sin(t);return new o(Math.roundTo(i*(this.X-e.X)-t*(this.Y-e.Y)+e.X,n),Math.roundTo(t*(this.X-e.X)+i*(this.Y-e.Y)+e.Y,n))},o.prototype.Apply=function(e){this.X=e(this.X),this.Y=e(this.Y)},o.prototype.Trigger=function(e){e(this.X),e(this.Y)},o.prototype.Normalized=function(){var e=this.Magnitude();return new o(this.X/e,this.Y/e)},o.prototype.Magnitude=function(){return Math.sqrt(this.X*this.X+this.Y*this.Y)},o.prototype.Length=function(){return this.Magnitude()},o.prototype.Dot=function(e){return e.X*this.X+e.Y*this.Y},o.prototype.Abs=function(){return new o(Math.abs(this.X),Math.abs(this.Y))},o.prototype.Sign=function(){return new o(this.X/Math.abs(this.X),this.Y/Math.abs(this.Y))},o.prototype.Unit=function(){var e=this.Magnitude();return new o(this.X/e,this.Y/e)},o.prototype.Distance=function(e){return new o(Math.abs(e.X-this.X),Math.abs(e.Y-this.Y))},o.prototype.Add=function(e){return"Vector2d"===e._type?new o(this.X+e.X,this.Y+e.Y):"Size2d"===e._type?new o(this.X+e.Width,this.Y+e.Height):new o(this.X+e,this.Y+e)},o.prototype.Multiply=function(e){return"Vector2d"===e._type?new o(this.X*e.X,this.Y*e.Y):"Size2d"===e._type?new o(this.X*e.Width,this.Y*e.Height):new o(this.X*e,this.Y*e)},o.prototype.Subtract=function(e){return"Vector2d"===e._type?new o(this.X-e.X,this.Y-e.Y):"Size2d"===e._type?new o(this.X-e.Width,this.Y-e.Height):new o(this.X-e,this.Y-e)},o.prototype.SubtractFrom=function(e){return"Vector2d"===e._type?new o(e.X-this.X,e.Y-this.Y):"Size2d"===e._type?new o(e.Width-this.X,e.Height=this.Y):new o(e-this.X,e-this.Y)},o.prototype.Divide=function(e){return"Vector2d"===e._type?new o(this.X/e.X,this.Y/e.Y):"Size2d"===e._type?new o(this.X/e.Width,this.Y/e.Height):new o(this.X/e,this.Y/e)},o.prototype.DivideFrom=function(e){return"Vector2d"===e._type?new o(e.X/this.X,e.Y/this.Y):"Size2d"===e._type?new o(e.Width/this.X,e.Height/this.Y):new o(e/this.X,e/this.Y)},o.prototype.IsZero=function(){return 0===this.X&&0===this.Y},o.prototype.Negate=function(){return new o(-1*this.X,-1*this.Y)},o.prototype.Equivalent=function(e){return this.X===e.X&&this.Y===e.Y},o.prototype.Clone=function(){return new o(this.X,this.Y)},o.prototype.toString=function(){return"("+this.X+", "+this.Y+")"},e.Vector2d=o}(EndGate=EndGate||{}),!function(e){!function(e){function t(e,t){this._boundsType="Bounds2d",this.Position=e,this.Rotation=t||0}t.prototype.Scale=function(e,t){throw new Error("This method is abstract!")},t.prototype.ContainsPoint=function(e){throw new Error("This method is abstract!")},t.prototype.ContainsCircle=function(e){throw new Error("This method is abstract!")},t.prototype.ContainsRectangle=function(e){throw new Error("This method is abstract!")},t.prototype.Contains=function(e){if("BoundingCircle"===e._boundsType)return this.ContainsCircle(e);if("BoundingRectangle"===e._boundsType)return this.ContainsRectangle(e);if("Vector2d"===e._type)return this.ContainsPoint(e);throw new Error("Cannot try and check contains with an unidentifiable object, must be a Vector2d, BoundingCircle or BoundingRectangle.")},t.prototype.Intersects=function(e){if("BoundingCircle"===e._boundsType)return this.IntersectsCircle(e);if("BoundingRectangle"===e._boundsType)return this.IntersectsRectangle(e);throw new Error("Cannot intersect with unidentifiable object, must be BoundingCircle or BoundingRectangle.")},t.prototype.IntersectsCircle=function(e){throw new Error("This method is abstract!")},t.prototype.IntersectsRectangle=function(e){throw new Error("This method is abstract!")},e.Bounds2d=t}(e.Bounds||(e.Bounds={}));e.Bounds}(EndGate=EndGate||{}),!function(e){var t=e._||(e._={});(function(e){function t(e){this._type="LooperCallback",this.Callback=e,this.ID=t._ids++}t._ids=0,e.LooperCallback=t})(t.Loopers||(t.Loopers={})),t.Loopers,e._}(EndGate=EndGate||{}),!function(e){!function(e){function t(e,t){i.call(this,t),this._type="TimedCallback",this.Fps=e,this.TimeoutID=0,this.Active=!1}var n,i;n=e.Loopers||(e.Loopers={}),i=n.LooperCallback,__extends(t,i),n.TimedCallback=t,e.Loopers}(e._||(e._={}));e._}(EndGate=EndGate||{}),!function(e){var t=e._||(e._={});(function(e){function t(){this._type="Looper",this._running=!1,this._callbacks=[]}t.prototype.AddCallback=function(e){var t=this;this._callbacks.push(e),e.Active=!0,this._running&&window.setTimeout(function(){t.Loop(e)},0)},t.prototype.RemoveCallback=function(e){for(var t=0;t<this._callbacks.length;t++)if(this._callbacks[t].ID===e.ID)return window.clearTimeout(e.TimeoutID),e.Active=!1,void this._callbacks.splice(t,1)},t.prototype.Start=function(){this._running=!0,this.Run()},t.prototype.Run=function(){for(var t=this,e=0;e<this._callbacks.length;e++)window.setTimeout(function(e){return function(){t.Loop(t._callbacks[e])}}(e),0)},t.prototype.Loop=function(e){var t=this,n=1e3/e.Fps;e.Callback(),e.Active&&(e.TimeoutID=window.setTimeout(function(){t.Loop(e)},n))},t.prototype.Dispose=function(){for(var e=this._callbacks.length-1;0<=e;e--)this.RemoveCallback(this._callbacks[e]);this._callbacks=[],this._running=!1},e.Looper=t})(t.Loopers||(t.Loopers={})),t.Loopers,e._}(EndGate=EndGate||{}),window.OnRepaintCompleted=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,0)},!function(e){var t=e._||(e._={});(function(e){function t(){this._type="RepaintLooper",this._running=!1,this._callbacksModified=!1,this._callbacks=[]}t.prototype.Start=function(){this._running=!0,this.Run()},t.prototype.Run=function(){var e=this;if(this._running){this._callbacksModified=!1;for(var t=0;t<this._callbacks.length&&(this._callbacks[t].Callback(),!this._callbacksModified);t++);window.OnRepaintCompleted(function(){e.Run()})}},t.prototype.AddCallback=function(e){this._callbacksModified=!0,this._callbacks.push(e)},t.prototype.RemoveCallback=function(e){for(var t=0;t<this._callbacks.length;t++)if(this._callbacks[t].ID===e.ID)return this._callbacksModified=!0,void this._callbacks.splice(t,1)},t.prototype.Dispose=function(){this._callbacksModified=!0,this._callbacks=[],this._running=!1},e.RepaintLooper=t})(t.Loopers||(t.Loopers={})),t.Loopers,e._}(EndGate=EndGate||{}),!function(e){!function(n){function e(){this._type="GameRunner",this._updateCallbacks={},this._drawCallbacks={},this._updateLoop=null,this._drawLoop=null,this._callbackCount=0}e.prototype.Register=function(e){var t=this.CreateAndCacheUpdateCallback(e),e=this.CreateAndCacheDrawCallback(e);return this._callbackCount++,this.TryLoopStart(),this._updateLoop.AddCallback(t),this._drawLoop.AddCallback(e),this.CreateUpdateRateSetter(t)},e.prototype.Unregister=function(e){var t,n;this._updateCallbacks[e._ID]&&(t=this._updateCallbacks[e._ID],n=this._drawCallbacks[e._ID],this._updateLoop.RemoveCallback(t),this._drawLoop.RemoveCallback(n),delete this._updateCallbacks[e._ID],delete this._drawCallbacks[e._ID],this._callbackCount--,this.TryLoopStop())},e.prototype.TryLoopStart=function(){1===this._callbackCount&&(this._updateLoop=new n.Loopers.Looper,this._updateLoop.Start(),this._drawLoop=new n.Loopers.RepaintLooper,this._drawLoop.Start())},e.prototype.TryLoopStop=function(){0===this._callbackCount&&null!=this._updateLoop&&(this._updateLoop.Dispose(),this._updateLoop=null,this._drawLoop.Dispose(),this._drawLoop=null)},e.prototype.CreateAndCacheUpdateCallback=function(e){var t=new n.Loopers.TimedCallback(0,function(){e._PrepareUpdate()});return this._updateCallbacks[e._ID]=t},e.prototype.CreateAndCacheDrawCallback=function(e){var t=new n.Loopers.LooperCallback(function(){e._PrepareDraw()});return this._drawCallbacks[e._ID]=t},e.prototype.CreateUpdateRateSetter=function(t){return function(e){t.Fps=e}},n.GameRunner=e}(e._||(e._={}));e._}(EndGate=EndGate||{}),new EndGate._.GameRunner);function asyncLoop(n,i,o){!function e(t){t<i?n(function(){e(t+1)},t):o&&o()}(0)}!function(e){function t(){this._type="EventHandler",this._actions=[]}t.prototype.Bind=function(e){this._actions.push(e)},t.prototype.BindFor=function(e,t){function n(){++o>=t&&i.Unbind(n),e.apply(this,arguments)}var i=this,o=0;this._actions.push(n)},t.prototype.Unbind=function(e){for(var t=0;t<this._actions.length;t++)if(this._actions[t]===e)return void this._actions.splice(t,1)},t.prototype.HasBindings=function(){return 0<this._actions.length},t.prototype.Trigger=function(){if(this.HasBindings())for(var e=this._actions.slice(0),t=0;t<e.length;t++)e[t]()},t.prototype.Dispose=function(){this._actions=[]},e.EventHandler=t}(EndGate=EndGate||{}),function(n){!function(e){function t(e){this._initialQuadTreeSize=e,this._minQuadTreeNodeSize=t._DefaultMinQuadTreeNodeSize,this._OnChange=new n.EventHandler}Object.defineProperty(t.prototype,"MinQuadTreeNodeSize",{get:function(){return this._minQuadTreeNodeSize.Clone()},set:function(e){if(e.Width!==e.Height)throw new Error("MinQuadTreeNodeSize must be a square.  Width and height must be identical.");this._minQuadTreeNodeSize=e,this._OnChange.Trigger()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"InitialQuadTreeSize",{get:function(){return this._initialQuadTreeSize},set:function(e){if(e.Width!==e.Height)throw new Error("InitialQuadTreeSize must be a square.  Width and height must be identical.");if(e.Width%this._minQuadTreeNodeSize.Width!=0)throw new Error("InitialQuadTreeSize must be divisible by the MinQuadTreeNodeSize.");this._initialQuadTreeSize=e,this._OnChange.Trigger()},enumerable:!0,configurable:!0}),t._DefaultMinQuadTreeNodeSize=new n.Size2d(32),e.CollisionConfiguration=t}(n.Collision||(n.Collision={}));n.Collision}(EndGate=EndGate||{}),function(n){function e(e,t){this._defaultUpdateRate=65,this.DrawOnlyAfterUpdate=!0,this._updateRateSetter=e,this.UpdateRate=this._defaultUpdateRate,this._collisionConfiguration=new n.Collision.CollisionConfiguration(t)}Object.defineProperty(e.prototype,"UpdateRate",{get:function(){return this._updateRate},set:function(e){this._updateRate=e,this._updateRateSetter(this._updateRate)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CollisionConfiguration",{get:function(){return this._collisionConfiguration},enumerable:!0,configurable:!0}),n.GameConfiguration=e}(EndGate=EndGate||{}),function(e){(e._||(e._={})).MinMax=function(e,t){this.Min=e,this.Max=t};e._}(EndGate=EndGate||{}),function(e){!function(s){function e(){}e.GetMinMaxProjections=function(e,t){for(var n=t[0].ProjectOnto(e).Dot(e),i=n,o=1;o<t.length;o++){var r=t[o].ProjectOnto(e).Dot(e);r<n?n=r:i<r&&(i=r)}return new s.MinMax(n,i)},s.Vector2dHelpers=e}(e._||(e._={}));e._}(EndGate=EndGate||{}),function(e){function t(e,t){i.call(this,e),this._type="BoundingCircle",this._boundsType="BoundingCircle",this.Radius=t}var n,i;n=e.Bounds||(e.Bounds={}),i=n.Bounds2d,__extends(t,i),t.prototype.Scale=function(e){this.Radius*=e},t.prototype.Area=function(){return Math.PI*this.Radius*this.Radius},t.prototype.Circumference=function(){return 2*Math.PI*this.Radius},t.prototype.IntersectsCircle=function(e){return this.Position.Distance(e.Position).Length()<this.Radius+e.Radius},t.prototype.IntersectsRectangle=function(e){var t=(0===e.Rotation?this.Position:this.Position.RotateAround(e.Position,-e.Rotation)).Distance(e.Position);return!(t.X>e.Size.HalfWidth+this.Radius)&&(!(t.Y>e.Size.HalfHeight+this.Radius)&&(t.X<=e.Size.HalfWidth||(t.Y<=e.Size.HalfHeight||Math.pow(t.X-e.Size.HalfWidth,2)+Math.pow(t.Y-e.Size.HalfHeight,2)<=this.Radius*this.Radius)))},t.prototype.ContainsPoint=function(e){return this.Position.Distance(e).Magnitude()<this.Radius},t.prototype.ContainsCircle=function(e){return e.Position.Distance(this.Position).Length()+e.Radius<=this.Radius},t.prototype.ContainsRectangle=function(e){for(var t=e.Corners(),n=0;n<t.length;n++)if(!this.ContainsPoint(t[n]))return!1;return!0},n.BoundingCircle=t,e.Bounds}(EndGate=EndGate||{}),function(c){function e(e,t){n.call(this,e),this._type="BoundingRectangle",this._boundsType="BoundingRectangle",this.Size=t}var t,n;t=c.Bounds||(c.Bounds={}),n=t.Bounds2d,__extends(e,n),e.prototype.Scale=function(e,t){this.Size.Width*=e,this.Size.Height*=t},Object.defineProperty(e.prototype,"TopLeft",{get:function(){return 0===this.Rotation?new c.Vector2d(this.Position.X-this.Size.HalfWidth,this.Position.Y-this.Size.HalfHeight):new c.Vector2d(this.Position.X-this.Size.HalfWidth,this.Position.Y-this.Size.HalfHeight).RotateAround(this.Position,this.Rotation)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TopRight",{get:function(){return 0===this.Rotation?new c.Vector2d(this.Position.X+this.Size.HalfWidth,this.Position.Y-this.Size.HalfHeight):new c.Vector2d(this.Position.X+this.Size.HalfWidth,this.Position.Y-this.Size.HalfHeight).RotateAround(this.Position,this.Rotation)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"BotLeft",{get:function(){return 0===this.Rotation?new c.Vector2d(this.Position.X-this.Size.HalfWidth,this.Position.Y+this.Size.HalfHeight):new c.Vector2d(this.Position.X-this.Size.HalfWidth,this.Position.Y+this.Size.HalfHeight).RotateAround(this.Position,this.Rotation)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"BotRight",{get:function(){return 0===this.Rotation?new c.Vector2d(this.Position.X+this.Size.HalfWidth,this.Position.Y+this.Size.HalfHeight):new c.Vector2d(this.Position.X+this.Size.HalfWidth,this.Position.Y+this.Size.HalfHeight).RotateAround(this.Position,this.Rotation)},enumerable:!0,configurable:!0}),e.prototype.Corners=function(){return[this.TopLeft,this.TopRight,this.BotLeft,this.BotRight]},e.prototype.IntersectsCircle=function(e){return e.IntersectsRectangle(this)},e.prototype.IntersectsRectangle=function(e){var t,n,i,o;if(0===this.Rotation&&0===e.Rotation)return t=this.TopLeft,n=this.BotRight,i=e.TopLeft,o=e.BotRight,i.X<=n.X&&o.X>=t.X&&i.Y<=n.Y&&o.Y>=t.Y;if(e.Position.Distance(this.Position).Magnitude()<=e.Size.Radius+this.Size.Radius){for(var r=[this.TopRight.Subtract(this.TopLeft),this.TopRight.Subtract(this.BotRight),e.TopLeft.Subtract(e.BotLeft),e.TopLeft.Subtract(e.TopRight)],s=this.Corners(),a=e.Corners(),u=0;u<r.length;u++){var l=r[u],h=c._.Vector2dHelpers.GetMinMaxProjections(l,s),l=c._.Vector2dHelpers.GetMinMaxProjections(l,a);if(l.Max<h.Min||h.Max<l.Min)return!1}return!0}return!1},e.prototype.ContainsPoint=function(e){var t=this.Rotation,n=(0!==this.Rotation&&(this.Rotation=0,e=e.RotateAround(this.Position,-t)),this.TopLeft),i=this.BotRight;return this.Rotation=t,e.X<=i.X&&e.X>=n.X&&e.Y<=i.Y&&e.Y>=n.Y},e.prototype.ContainsCircle=function(e){return this.ContainsPoint(new c.Vector2d(e.Position.X-e.Radius,e.Position.Y))&&this.ContainsPoint(new c.Vector2d(e.Position.X,e.Position.Y-e.Radius))&&this.ContainsPoint(new c.Vector2d(e.Position.X+e.Radius,e.Position.Y))&&this.ContainsPoint(new c.Vector2d(e.Position.X,e.Position.Y+e.Radius))},e.prototype.ContainsRectangle=function(e){for(var t=e.Corners(),n=0;n<t.length;n++)if(!this.ContainsPoint(t[n]))return!1;return!0},t.BoundingRectangle=e,c.Bounds}(EndGate=EndGate||{}),function(e){function t(){this._type="EventHandler1",this._actions=[]}t.prototype.Bind=function(e){this._actions.push(e)},t.prototype.BindFor=function(e,t){function n(){++o>=t&&i.Unbind(n),e.apply(this,arguments)}var i=this,o=0;this._actions.push(n)},t.prototype.Unbind=function(e){for(var t=0;t<this._actions.length;t++)if(this._actions[t]===e)return void this._actions.splice(t,1)},t.prototype.HasBindings=function(){return 0<this._actions.length},t.prototype.Trigger=function(e){if(this.HasBindings())for(var t=this._actions.slice(0),n=0;n<t.length;n++)t[n](e)},t.prototype.Dispose=function(){this._actions=[]},e.EventHandler1=t}(EndGate=EndGate||{}),function(e){(e.Collision||(e.Collision={})).CollisionData=function(e){this.With=e};e.Collision}(EndGate=EndGate||{}),function(n){!function(e){function t(e){this._type="Collidable",this._disposed=!1,this.Bounds=e,this._id=t._collidableIDs++,this._onCollision=new n.EventHandler1,this._onDisposed=new n.EventHandler1}Object.defineProperty(t.prototype,"OnCollision",{get:function(){return this._onCollision},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"OnDisposed",{get:function(){return this._onDisposed},enumerable:!0,configurable:!0}),t.prototype.IsCollidingWith=function(e){return this.Bounds.Intersects(e.Bounds)},t.prototype.Collided=function(e){this.OnCollision.Trigger(e)},t.prototype.Dispose=function(){if(this._disposed)throw new Error("Cannot dispose collidable more than once.");this._disposed=!0,this.OnDisposed.Trigger(this),this.OnDisposed.Dispose(),this.OnCollision.Dispose()},t._collidableIDs=0,e.Collidable=t}(n.Collision||(n.Collision={}));n.Collision}(EndGate=EndGate||{}),function(r){var i=r.Collision||(r.Collision={});(function(e){function n(e,t,n,i){o.call(this,new r.Bounds.BoundingRectangle(e,t)),this._minNodeSize=n,this._children=new Array,this.Contents=new Array,this.Parent=i,this._partitioned=!1}var t,o;t=e._||(e._={}),o=i.Collidable,__extends(n,o),Object.defineProperty(n.prototype,"Children",{get:function(){return this._children},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"TopLeftChild",{get:function(){return this._children[0]},set:function(e){this._children[0]=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"TopRightChild",{get:function(){return this._children[1]},set:function(e){this._children[1]=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"BotLeftChild",{get:function(){return this._children[2]},set:function(e){this._children[2]=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"BotRightChild",{get:function(){return this._children[3]},set:function(e){this._children[3]=e},enumerable:!0,configurable:!0}),n.prototype.IsPartitioned=function(){return this._partitioned},n.prototype.Partition=function(){var e=new r.Size2d(Math.round(.5*this.Bounds.Size.Width)),t=this.Bounds.Position;this._partitioned=!0,e.Width<this._minNodeSize.Width||(this._children.push(new n(t.Subtract(e.Multiply(.5)),e,this._minNodeSize,this)),this._children.push(new n(new r.Vector2d(t.X+e.Width/2,t.Y-e.Height/2),e,this._minNodeSize,this)),this._children.push(new n(new r.Vector2d(t.X-e.Width/2,t.Y+e.Height/2),e,this._minNodeSize,this)),this._children.push(new n(t.Add(e.Multiply(.5)),e,this._minNodeSize,this)))},n.prototype.Insert=function(e){this._partitioned||this.Partition();for(var t=0;t<this._children.length;t++)if(this._children[t].Bounds.Contains(e.Bounds))return this._children[t].Insert(e);return this.Contents.push(e),this},n.prototype.ReverseInsert=function(e){return this.Bounds.Contains(e.Bounds)||null==this.Parent?this.Insert(e):this.Parent.ReverseInsert(e)},n.prototype.Query=function(e){for(var t,n=new Array,i=0;i<this.Contents.length;i++)e.Intersects(this.Contents[i].Bounds)&&n.push(this.Contents[i]);for(i=0;i<this._children.length;i++){if((t=this._children[i]).Bounds.Contains(e)){n=n.concat(t.Query(e));break}e.Contains(t.Bounds)?n=n.concat(t.GetSubTreeContents()):t.Bounds.Intersects(e)&&(n=n.concat(t.Query(e)))}return n},n.prototype.Remove=function(e){e=this.Contents.indexOf(e);0<=e&&this.Contents.splice(e,1)},n.prototype.GetSubTreeContents=function(){for(var e=new Array,t=0;t<this._children.length;t++)e=e.concat(this._children[t].GetSubTreeContents());return e=e.concat(this.Contents)},t.QuadTreeNode=n,e._})(i.Assets||(i.Assets={})),i.Assets,r.Collision}(EndGate=EndGate||{}),function(t){var e,n;e=t.Collision||(t.Collision={}),function(u){function e(e){this._disposed=!1,this._minNodeSize=e.MinQuadTreeNodeSize,this._collidableMap={},this._updateableCollidableMap={},this._root=new u.QuadTreeNode(new t.Vector2d(e.InitialQuadTreeSize.HalfWidth,e.InitialQuadTreeSize.HalfHeight),e.InitialQuadTreeSize,e.MinQuadTreeNodeSize,null)}e.prototype.Insert=function(e,t){void 0===t&&(t=!1),this._root.Bounds.Contains(e.Bounds)||this.Expand(e),this._collidableMap[e._id]={Node:this._root.Insert(e),Collidable:e,StaticPosition:t},t||(this._updateableCollidableMap[e._id]=this._collidableMap[e._id])},e.prototype.Remove=function(e){var t=this._collidableMap[e._id].Node;delete this._collidableMap[e._id],delete this._updateableCollidableMap[e._id],t.Remove(e)},e.prototype.CollisionCandidates=function(e){for(var t=this._collidableMap[e._id].Node,n=t.GetSubTreeContents();null!==t.Parent;)n=n.concat(t.Parent.Contents),t=t.Parent;return n},e.prototype.Query=function(e){return this._root.Query(e)},e.prototype.Expand=function(e){var t,n=this._root.Bounds,i=n.TopLeft.Distance(e.Bounds.Position).Length(),o=n.TopRight.Distance(e.Bounds.Position).Length(),r=n.BotLeft.Distance(e.Bounds.Position).Length(),e=n.BotRight.Distance(e.Bounds.Position).Length(),s=Math.min(i,o,r,e),a=n.Size.Multiply(2);s===i?((t=new u.QuadTreeNode(n.TopLeft,a,this._minNodeSize,null)).Partition(),t.BotRightChild=this._root):s===o?((t=new u.QuadTreeNode(n.TopRight,a,this._minNodeSize,null)).Partition(),t.BotLeftChild=this._root):s===r?((t=new u.QuadTreeNode(n.BotLeft,a,this._minNodeSize,null)).Partition(),t.TopRightChild=this._root):s===e&&((t=new u.QuadTreeNode(n.BotRight,a,this._minNodeSize,null)).Partition(),t.TopLeftChild=this._root),this._root.Parent=t,this._root=t},e.prototype.Update=function(e){var t,n,i;for(i in this._updateableCollidableMap)n=(t=this._updateableCollidableMap[i]).Node,t=t.Collidable,n.Remove(t),n=this._root.Bounds.Contains(t.Bounds)?n.Bounds.Contains(t.Bounds)||null==n.Parent?n.Insert(t):n.Parent.ReverseInsert(t):(this.Expand(t),this._root.Insert(t)),this._updateableCollidableMap[i].Node=n},e.prototype.Dispose=function(){if(this._disposed)throw new Error("Cannot dispose collidable more than once.");this._disposed=!0},u.QuadTree=e}((n=e.Assets||(e.Assets={}))._||(n._={})),n._,e.Assets,t.Collision}(EndGate=EndGate||{}),function(e){function t(){this._type="EventHandler2",this._actions=[]}t.prototype.Bind=function(e){this._actions.push(e)},t.prototype.BindFor=function(e,t){function n(){++o>=t&&i.Unbind(n),e.apply(this,arguments)}var i=this,o=0;this._actions.push(n)},t.prototype.Unbind=function(e){for(var t=0;t<this._actions.length;t++)if(this._actions[t]===e)return void this._actions.splice(t,1)},t.prototype.HasBindings=function(){return 0<this._actions.length},t.prototype.Trigger=function(e,t){if(this.HasBindings())for(var n=this._actions.slice(0),i=0;i<n.length;i++)n[i](e,t)},t.prototype.Dispose=function(){this._actions=[]},e.EventHandler2=t}(EndGate=EndGate||{}),function(t){!function(u){function e(e){this._type="CollisionManager",this._collidables=[],this._nonStaticCollidables=[],this._quadTree=new u.Assets._.QuadTree(e),this._enabled=!1,this._disposed=!1,this._onCollision=new t.EventHandler2}Object.defineProperty(e.prototype,"OnCollision",{get:function(){return this._onCollision},enumerable:!0,configurable:!0}),e.prototype.Monitor=function(e,t){void 0===t&&(t=!1);var n=this,i={Collidable:e,Unmonitor:function(e){n.Unmonitor(e)}};this._enabled=!0,e.OnDisposed.Bind(i.Unmonitor),this._collidables.push(i),t||this._nonStaticCollidables.push(e),this._quadTree.Insert(e)},e.prototype.Unmonitor=function(e){for(var t,n=0;n<this._collidables.length;n++)if(this._collidables[n].Collidable._id===e._id){this._collidables[n].Collidable.OnDisposed.Unbind(this._collidables[n].Unmonitor),this._collidables.splice(n,1);break}0<=(t=this._nonStaticCollidables.indexOf(e))&&this._nonStaticCollidables.splice(t,1),this._quadTree.Remove(e)},e.prototype.Update=function(e){var t,n={},i=new Array;if(this._enabled){this._quadTree.Update(e);for(var o=0;o<this._nonStaticCollidables.length;o++)for(var r=this._nonStaticCollidables[o],s=this._quadTree.CollisionCandidates(r),a=0;a<s.length;a++)r._id!==s[a]._id&&r.IsCollidingWith(s[a])&&i.push([r,s[a]]);for(o=0;o<i.length;o++)n[t=this.HashIds(i[o][0],i[o][1])]||(n[t]=!0,i[o][0].Collided(new u.CollisionData(i[o][1])),i[o][1].Collided(new u.CollisionData(i[o][0])),this.OnCollision.Trigger(i[o][0],i[o][1]))}},e.prototype.Dispose=function(){if(this._disposed)throw new Error("CollisionManager cannot be disposed more than once");this._disposed=!0;for(var e=0;e<this._collidables.length;e++)this.Unmonitor(this._collidables[e].Collidable);this._collidables=[],this._nonStaticCollidables=[],this._onCollision.Dispose(),this._quadTree=null},e.prototype.HashIds=function(e,t){return Math.min(e._id,t._id).toString()+Math.max(t._id,e._id).toString()},u.CollisionManager=e}(t.Collision||(t.Collision={}));t.Collision}(EndGate=EndGate||{}),function(e){var t,n;t=e.Graphics||(e.Graphics={}),function(e){function t(){this._cachedState={}}Object.defineProperty(t.prototype,"StrokeStyle",{get:function(){return this._cachedState.strokeStyle},set:function(e){this._cachedState.strokeStyle=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FillStyle",{get:function(){return this._cachedState.fillStyle},set:function(e){this._cachedState.fillStyle=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"GlobalAlpha",{get:function(){return this._cachedState.globalAlpha},set:function(e){this._cachedState.globalAlpha=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"LineWidth",{get:function(){return this._cachedState.lineWidth},set:function(e){this._cachedState.lineWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"LineCap",{get:function(){return this._cachedState.lineCap},set:function(e){this._cachedState.lineCap=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"LineJoin",{get:function(){return this._cachedState.lineJoin},set:function(e){this._cachedState.lineJoin=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"MiterLimit",{get:function(){return this._cachedState.miterLimit},set:function(e){this._cachedState.miterLimit=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ShadowOffsetX",{get:function(){return this._cachedState.shadowOffsetX},set:function(e){this._cachedState.shadowOffsetX=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ShadowOffsetY",{get:function(){return this._cachedState.shadowOffsetY},set:function(e){this._cachedState.shadowOffsetY=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ShadowBlur",{get:function(){return this._cachedState.shadowBlur},set:function(e){this._cachedState.shadowBlur=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ShadowColor",{get:function(){return this._cachedState.shadowColor},set:function(e){this._cachedState.shadowColor=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"GlobalCompositeOperation",{get:function(){return this._cachedState.globalCompositeOperation},set:function(e){this._cachedState.globalCompositeOperation=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Font",{get:function(){return this._cachedState.font},set:function(e){this._cachedState.font=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TextAlign",{get:function(){return this._cachedState.textAlign},set:function(e){this._cachedState.textAlign=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TextBaseline",{get:function(){return this._cachedState.textBaseline},set:function(e){this._cachedState.textBaseline=e},enumerable:!0,configurable:!0}),t.prototype.SetContextState=function(e){for(var t in this._cachedState)e[t]=this._cachedState[t]},e.Graphic2dState=t}((n=t.Assets||(t.Assets={}))._||(n._={})),n._,t.Assets,e.Graphics}(EndGate=EndGate||{}),function(n){!function(t){function i(e){this._type="Graphic2d",this.Position=e,this.Rotation=0,this.ZIndex=0,this.Visible=!0,this._State=new t.Assets._.Graphic2dState,this.Opacity=1,this._children=[],this._childrenRemovalBindings=[],this.Parent=null,this._disposed=!1,this._onDisposed=new n.EventHandler1}Object.defineProperty(i.prototype,"AbsolutePosition",{get:function(){for(var e=this.Position,t=this;t=t.Parent;)e=e.Add(t.Position);return e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"OnDisposed",{get:function(){return this._onDisposed},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Opacity",{get:function(){return this._State.GlobalAlpha},set:function(e){this._State.GlobalAlpha=e},enumerable:!0,configurable:!0}),i.prototype.GetChildren=function(){return this._children.slice(0)},i.prototype.AddChild=function(e){var t,n=this;if(null!==e.Parent)throw new Error("Graphic already has parent, cannot add it as a child.");t=function(e){n.RemoveChild(e)},e.Parent=this,e.OnDisposed.Bind(t),this._children.push(e),this._childrenRemovalBindings.push(t),this._children.sort(i._zindexSort)},i.prototype.RemoveChild=function(e){e=this._children.indexOf(e);return 0<=e&&(this._children[e].Parent=null,this._children[e].OnDisposed.Unbind(this._childrenRemovalBindings[e]),this._children.splice(e,1),this._childrenRemovalBindings.splice(e,1),!0)},i.prototype._StartDraw=function(e){e.save(),this._State.SetContextState(e),e.translate(this.Position.X,this.Position.Y),0!==this.Rotation&&e.rotate(this.Rotation)},i.prototype._EndDraw=function(e){for(var t=0;t<this._children.length;t++)this._children[t].Visible&&this._children[t].Draw(e);e.restore()},i.prototype.Draw=function(e){throw new Error("The Draw method is abstract on Graphic2d and should not be called.")},i.prototype.GetDrawBounds=function(){throw new Error("GetDrawBounds is abstract, it must be implemented.")},i.prototype.Scale=function(e){throw new Error("Scale is abstract, it must be implemented.")},i.prototype.Clone=function(){throw new Error("Clone is abstract, it must be implemented.")},i.prototype._Clone=function(e){for(var t=0;t<this._children.length;t++)e.AddChild(this._children[t].Clone());e.Opacity=this.Opacity,e.Rotation=this.Rotation,e.Visible=this.Visible,e.ZIndex=this.ZIndex},i.prototype.Dispose=function(){if(this._disposed)throw new Error("Cannot dispose graphic more than once.");this._disposed=!0;for(var e=this._children.slice(0),t=0;t<e.length;t++)e[t].Dispose();this._children=null,this.OnDisposed.Trigger(this),this.OnDisposed.Dispose()},i._zindexSort=function(e,t){return e.ZIndex-t.ZIndex},t.Graphic2d=i}(n.Graphics||(n.Graphics={}));n.Graphics}(EndGate=EndGate||{}),function(e){function n(e,t){i.call(this,e,t),this._type="Camera2d",this.Distance=n.DefaultDistance}var t,i;t=e.Rendering||(e.Rendering={}),i=e.Bounds.BoundingRectangle,__extends(n,i),n.prototype.ToCameraRelative=function(e){return this.Position.Subtract(this.Size.Multiply(.5*this._GetDistanceScale())).Add(e.Multiply(this._GetDistanceScale()))},n.prototype._GetInverseDistanceScale=function(){return n.DefaultDistance/this.Distance},n.prototype._GetDistanceScale=function(){return this.Distance/n.DefaultDistance},n.DefaultDistance=1e3,t.Camera2d=n,e.Rendering}(EndGate=EndGate||{}),function(t){!function(e){function n(e){this._visibleCanvas=e,this._visibleContext=e.getContext("2d"),this._BufferCanvas=document.createElement("canvas"),this._BufferContext=this._BufferCanvas.getContext("2d"),this._onRendererSizeChange=new t.EventHandler1,this.UpdateBufferSize(),this._disposed=!1}Object.defineProperty(n.prototype,"OnRendererSizeChange",{get:function(){return this._onRendererSizeChange},enumerable:!0,configurable:!0}),n.prototype.Render=function(e){this._BufferCanvas.width===this._visibleCanvas.width&&this._BufferCanvas.height===this._visibleCanvas.height||this.UpdateBufferSize(),this._visibleContext.clearRect(0,0,this._visibleCanvas.width,this._visibleCanvas.height),this._visibleContext.drawImage(this._BufferCanvas,0,0),this._ClearBuffer(),e.sort(n._zindexSort);for(var t=0;t<e.length;t++)e[t].Draw(this._BufferContext);return this._BufferContext},n.prototype.Dispose=function(){this._disposed||(this._disposed=!0,this._visibleCanvas.parentNode.removeChild(this._visibleCanvas),this._onRendererSizeChange.Dispose())},n.prototype._ClearBuffer=function(){this._BufferContext.clearRect(0,0,this._BufferCanvas.width,this._BufferCanvas.height)},n.prototype.UpdateBufferSize=function(){this._BufferCanvas.width=this._visibleCanvas.width,this._BufferCanvas.height=this._visibleCanvas.height,this.OnRendererSizeChange.Trigger(new t.Size2d(this._visibleCanvas.width,this._visibleCanvas.height))},n._zindexSort=function(e,t){return e.ZIndex-t.ZIndex},e.Renderer2d=n}(t.Rendering||(t.Rendering={}));t.Rendering}(EndGate=EndGate||{}),function(e){var t=e.Rendering||(e.Rendering={});(function(e){function t(e){this._camera=e,this._canvasCenter=this._camera.Position.Clone(),this._translated=!1,this._translationState=[],this._translationState.push(this._translated)}t.prototype.Build=function(e){var t=this,n=e.createRadialGradient,i=e.translate,o=e.save,r=e.restore,s=this.BuildPositionReplacer(e.drawImage,1),a=this.BuildPositionReplacer(e.drawImage,5);return e.unModifiedClearRect=e.clearRect,e.arc=this.BuildPositionReplacer(e.arc),e.arcTo=this.BuildPositionReplacer(e.arcTo,0,4),e.bezierCurveTo=this.BuildPositionReplacer(e.bezierCurveTo,0,6),e.clearRect=this.BuildPositionReplacer(e.clearRect),e.createLinearGradient=this.BuildPositionReplacer(e.createLinearGradient,0,4),e.createRadialGradient=function(){var e=t._camera._GetDistanceScale();return arguments[0]+=-t._camera.Position.X+t._canvasCenter.X*e,arguments[1]+=-t._camera.Position.Y+t._canvasCenter.Y*e,arguments[3]+=-t._camera.Position.X+t._canvasCenter.X*e,arguments[4]+=-t._camera.Position.Y+t._canvasCenter.Y*e,n.apply(this,arguments)},e.drawImage=function(){(arguments.length<=5?s:a).apply(this,arguments)},e.fillRect=this.BuildPositionReplacer(e.fillRect),e.fillText=this.BuildPositionReplacer(e.fillText,1),e.getImageData=this.BuildPositionReplacer(e.getImageData),e.isPointInPath=this.BuildPositionReplacer(e.isPointInPath),e.lineTo=this.BuildPositionReplacer(e.lineTo),e.moveTo=this.BuildPositionReplacer(e.moveTo),e.putImageData=this.BuildPositionReplacer(e.putImageData,1),e.quadraticCurveTo=this.BuildPositionReplacer(e.quadraticCurveTo,0,4),e.rect=this.BuildPositionReplacer(e.rect),e.strokeRect=this.BuildPositionReplacer(e.strokeRect),e.strokeText=this.BuildPositionReplacer(e.strokeText,1),e.save=function(){t._translationState.push(t._translated),o.call(this)},e.restore=function(){t._translated=t._translationState.pop(),r.call(this)},e.translate=function(){var e;t._translated||(e=t._camera._GetDistanceScale(),arguments[0]+=-t._camera.Position.X+t._canvasCenter.X*e,arguments[1]+=-t._camera.Position.Y+t._canvasCenter.Y*e),t._translated=!0,i.apply(this,arguments)},e},t.prototype._UpdateCanvasCenter=function(e){this._canvasCenter.X=e.Width/2,this._canvasCenter.Y=e.Height/2},t.prototype.BuildPositionReplacer=function(i,o,r){void 0===o&&(o=0),void 0===r&&(r=2);var s=this,a=["X","Y"];return function(){var e;if(!s._translated)for(var t=s._camera._GetDistanceScale(),n=0;n<r;n++)e=a[n%2],arguments[o+n]+=-s._camera.Position[e]+s._canvasCenter[e]*t;return i.apply(this,arguments)}},e.Camera2dCanvasContextBuilder=t})(t._||(t._={})),t._,e.Rendering}(EndGate=EndGate||{}),function(i){function e(e,t){var n=this;r.call(this,e),this._camera=t,this._contextBuilder=new o._.Camera2dCanvasContextBuilder(this._camera),this.OnRendererSizeChange.Bind(function(e){n._contextBuilder._UpdateCanvasCenter(e),n._camera.Size=e}),this._contextBuilder._UpdateCanvasCenter(new i.Size2d(e.width,e.height)),this._BufferContext=this._contextBuilder.Build(this._BufferContext)}var o,r;o=i.Rendering||(i.Rendering={}),r=o.Renderer2d,__extends(e,r),e.prototype.Render=function(e){var t=this._camera._GetInverseDistanceScale();return this._BufferContext.save(),this._BufferContext.scale(t,t),t=r.prototype.Render.call(this,this.GetOnScreenRenderables(e)),this._BufferContext.restore(),t},e.prototype._ClearBuffer=function(){var e=this._camera._GetDistanceScale();this._BufferContext.unModifiedClearRect(0,0,this._BufferCanvas.width*e,this._BufferCanvas.height*e)},e.prototype.GetOnScreenRenderables=function(e){var t=[],n=this._camera._GetDistanceScale(),i=1/n;this._camera.Scale(n,n);for(var o=0;o<e.length;o++)e[o].Visible&&this._camera.Intersects(e[o].GetDrawBounds())&&t.push(e[o]);return this._camera.Scale(i,i),t},o.Camera2dRenderer=e,i.Rendering}(EndGate=EndGate||{}),function(i){!function(n){function e(e,t){void 0===e&&(e=function(e){}),this._actorMappings=[],this._actors=[],void 0===t&&(t=this.CreateDefaultDrawArea()),this._onDraw=e,this._drawArea=t,this._camera=new n.Camera2d(new i.Vector2d(this._drawArea.width/2,this._drawArea.height/2),new i.Size2d(this._drawArea.width,this._drawArea.height)),this._renderer=new n.Camera2dRenderer(this._drawArea,this._camera),this._disposed=!1}Object.defineProperty(e.prototype,"DrawArea",{get:function(){return this._drawArea},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Camera",{get:function(){return this._camera},enumerable:!0,configurable:!0}),e.prototype.Add=function(e){var t=this,n={Actor:e,Remove:function(e){t.Remove(e)}};e.OnDisposed.Bind(n.Remove),this._actorMappings.push(n),this._actors.push(e)},e.prototype.Remove=function(e){for(var t=0;t<this._actors.length;t++)if(this._actors[t]===e)return this._actors[t].OnDisposed.Unbind(this._actorMappings[t].Remove),this._actors.splice(t,1),void this._actorMappings.splice(t,1)},e.prototype.Draw=function(){this._onDraw(this._renderer.Render(this._actors))},e.prototype.Dispose=function(){if(this._disposed)throw new Error("Scene2d cannot be disposed more than once");this._disposed=!0;for(var e=0;e<this._actors.length;e++)this.Remove(this._actors[e]);this._actors=[],this._actorMappings=[],this._renderer.Dispose()},e.prototype.CreateDefaultDrawArea=function(){var e=document.createElement("canvas"),t=document.getElementsByTagName("body")[0];return e.width=document.documentElement.clientWidth,e.height=document.documentElement.clientHeight-5,t.appendChild(e),t.style.margin="0px",t.style.padding="0px",e},n.Scene2d=e}(i.Rendering||(i.Rendering={}));i.Rendering}(EndGate=EndGate||{}),function(e){var t=e.Input||(e.Input={});(function(e){function t(){}t.Left="Left",t.Middle="Middle",t.Right="Right",e.MouseButton=t})(t._||(t._={})),t._,e.Input}(EndGate=EndGate||{}),function(n){function t(e){var t=this;this._target=e,this._disposed=!1,this._onClick=new n.EventHandler1,this._onDoubleClick=new n.EventHandler1,this._onDown=new n.EventHandler1,this._onUp=new n.EventHandler1,this._onMove=new n.EventHandler1,this._onScroll=new n.EventHandler1,this._leftIsDown=!1,this._middleIsDown=!1,this._rightIsDown=!1,this.Wire(),this.OnDown.Bind(function(e){t._isDown=!0,t[e.Button+"IsDown"]=!0,window.focus()}),this.OnUp.Bind(function(e){t._isDown=!1,t[e.Button+"IsDown"]=!1,window.focus()}),this.OnClick.Bind(function(e){window.focus()}),this.OnDoubleClick.Bind(function(e){window.focus()})}var i;i=n.Input||(n.Input={}),Object.defineProperty(t.prototype,"LeftIsDown",{get:function(){return this._leftIsDown},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"MiddleIsDown",{get:function(){return this._middleIsDown},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"RightIsDown",{get:function(){return this._rightIsDown},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsDown",{get:function(){return this._isDown},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"OnClick",{get:function(){return this._onClick},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"OnDoubleClick",{get:function(){return this._onDoubleClick},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"OnDown",{get:function(){return this._onDown},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"OnUp",{get:function(){return this._onUp},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"OnMove",{get:function(){return this._onMove},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"OnScroll",{get:function(){return this._onScroll},enumerable:!0,configurable:!0}),t.prototype.Dispose=function(){if(this._disposed)throw new Error("MouseHandler cannot be disposed more than once");this._disposed=!0,this._onClick.Dispose(),this._onDoubleClick.Dispose(),this._onDown.Dispose(),this._onMove.Dispose(),this._onScroll.Dispose(),this._onUp.Dispose(),this.Unwire(),this._target=null},t.prototype.Wire=function(){var t=this;this._clickWire=this._contextMenuWire=this.BuildEvent(this._onClick,this.BuildMouseClickEvent),this._dblClickWire=this.BuildEvent(this._onDoubleClick,this.BuildMouseClickEvent),this._mouseDownWire=this.BuildEvent(this._onDown,this.BuildMouseClickEvent),this._mouseUpWire=this.BuildEvent(this._onUp,this.BuildMouseClickEvent),this._mouseMoveWire=this.BuildEvent(this._onMove,this.BuildMouseEvent),/MSIE/i.test(navigator.userAgent)?(this._mouseWheelWireName="wheel",this._mouseWheelWire=this.BuildEvent(this._onScroll,function(e){return e.wheelDeltaX=-e.deltaX,e.wheelDeltaY=-e.deltaY,t.BuildMouseScrollEvent(e)})):/Firefox/i.test(navigator.userAgent)?(this._mouseWheelWireName="DOMMouseScroll",this._mouseWheelWire=this.BuildEvent(this._onScroll,function(e){return e.wheelDeltaX=1===e.axis?-e.detail:0,e.wheelDeltaY=2===e.axis?-e.detail:0,t.BuildMouseScrollEvent(e)})):(this._mouseWheelWireName="mousewheel",this._mouseWheelWire=this.BuildEvent(this._onScroll,this.BuildMouseScrollEvent)),this._target.addEventListener("click",this._clickWire,!1),this._target.addEventListener("contextmenu",this._contextMenuWire,!1),this._target.addEventListener("dblclick",this._dblClickWire,!1),this._target.addEventListener("mousedown",this._mouseDownWire,!1),this._target.addEventListener("mouseup",this._mouseUpWire,!1),this._target.addEventListener("mousemove",this._mouseMoveWire,!1),this._target.addEventListener(this._mouseWheelWireName,this._mouseWheelWire,!1)},t.prototype.Unwire=function(){this._target.removeEventListener("click",this._clickWire,!1),this._target.removeEventListener("contextmenu",this._contextMenuWire,!1),this._target.removeEventListener("dblclick",this._dblClickWire,!1),this._target.removeEventListener("mousedown",this._mouseDownWire,!1),this._target.removeEventListener("mouseup",this._mouseUpWire,!1),this._target.removeEventListener("mousemove",this._mouseMoveWire,!1),this._target.removeEventListener(this._mouseWheelWireName,this._mouseWheelWire,!1)},t.prototype.BuildEvent=function(t,n,i){void 0===i&&(i=!1);var o=this;return function(e){return t.HasBindings()&&t.Trigger(n.call(o,e)),e.preventDefault(),i}},t.prototype.BuildMouseScrollEvent=function(e){return{Position:this.GetMousePosition(e),Direction:this.GetMouseScrollDierction(e)}},t.prototype.BuildMouseEvent=function(e){return{Position:this.GetMousePosition(e)}},t.prototype.BuildMouseClickEvent=function(e){return{Position:this.GetMousePosition(e),Button:this.GetMouseButton(e)}},t.prototype.GetMousePosition=function(e){return new n.Vector2d(e.offsetX||e.pageX-this._target.offsetLeft,e.offsetY||e.pageY-this._target.offsetTop)},t.prototype.GetMouseButton=function(e){return e.which?t.MouseButtonArray[e.which]:i._.MouseButton.Right},t.prototype.GetMouseScrollDierction=function(e){return new n.Vector2d(-Math.max(-1,Math.min(1,e.wheelDeltaX)),-Math.max(-1,Math.min(1,e.wheelDeltaY)))},t.MouseButtonArray=[null,i._.MouseButton.Left,i._.MouseButton.Middle,i._.MouseButton.Right],i.MouseHandler=t,n.Input}(EndGate=EndGate||{}),function(e){var t=e._||(e._={});(function(e){function n(e,t){void 0===t&&(t=!1),this._invoker=n._noop,this._action=e,t&&this.Trip()}n.prototype.Invoke=function(){for(var e=[],t=0;t<+arguments.length;t++)e[t]=arguments[t+0];this._invoker.apply(this,e)},n.prototype.InvokeOnce=function(){for(var e=[],t=0;t<+arguments.length;t++)e[t]=arguments[t+0];this._invoker.apply(this,e),this.Reset()},n.prototype.Trip=function(){this._invoker=this._action},n.prototype.Reset=function(){this._invoker=n._noop},n._noop=function(){},e.NoopTripInvoker=n})(t.Utilities||(t.Utilities={})),t.Utilities,e._}(EndGate=EndGate||{}),function(e){var t=e.Input||(e.Input={});(function(e){function t(e,t,n){this.Ctrl=e,this.Alt=t,this.Shift=n}t.prototype.Equivalent=function(e){return this.Ctrl===e.Ctrl&&this.Alt===e.Alt&&this.Shift===e.Shift},t.BuildFromCommandString=function(e){return new t(0<=e.toLowerCase().indexOf("ctrl+"),0<=e.toLowerCase().indexOf("alt+"),0<=e.toLowerCase().indexOf("shift+"))},e.KeyboardModifiers=t})(t.Assets||(t.Assets={})),t.Assets,e.Input}(EndGate=EndGate||{}),function(e){!function(i){var o={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},r={27:"escape",9:"tab",32:"space",13:"enter",8:"backspace",45:"insert",36:"home",46:"delete",35:"end",37:"left",38:"up",39:"right",40:"down",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12"};function e(e){var t,n;this.Modifiers=new i.Assets.KeyboardModifiers(e.ctrlKey,e.altKey,e.shiftKey),e.keyCode?t=e.keyCode:e.which&&(t=e.which),(n=String.fromCharCode(e.keyCode))===(" "===e.key?"space":e.key)||(n=r[t])||(n=String.fromCharCode(t).toLowerCase(),this.Modifiers.Shift&&o[n]&&(n=o[n])),this.Key=n}e.prototype.Matches=function(e){return this.Key.toLowerCase()===e.Key.toLowerCase()&&e.Modifiers.Equivalent(this.Modifiers)},i.KeyboardCommandEvent=e}(e.Input||(e.Input={}));e.Input}(EndGate=EndGate||{}),function(e){var t=e.Input||(e.Input={});(function(e){function t(){}t.ParseKey=function(e){e=e.split("+");return 1<e.length?e[e.length-1]:e[0]},e.KeyboardCommandHelper=t})(t._||(t._={})),t._,e.Input}(EndGate=EndGate||{}),function(i){var o=i.Input||(i.Input={});(function(e){function t(e,t){var n=this;this.Action=t,this.Modifiers=o.Assets.KeyboardModifiers.BuildFromCommandString(e),this.Key=o._.KeyboardCommandHelper.ParseKey(e),this._onDisposed=new i.EventHandler,this._onDisposeInvoker=new i._.Utilities.NoopTripInvoker(function(){n._onDisposed.Trigger()},!0)}Object.defineProperty(t.prototype,"OnDispose",{get:function(){return this._onDisposed},enumerable:!0,configurable:!0}),t.prototype.Dispose=function(){this._onDisposeInvoker.InvokeOnce()},e.KeyboardCommand=t})(o.Assets||(o.Assets={})),o.Assets,i.Input}(EndGate=EndGate||{}),function(e){!function(a){function o(){this._onPressCommands={},this._onDownCommands={},this._onUpCommands={},this._onKeyPress=new e.EventHandler1,this._onKeyDown=new e.EventHandler1,this._onKeyUp=new e.EventHandler1,this._disposed=!1,this.Wire()}Object.defineProperty(o.prototype,"OnKeyPress",{get:function(){return this._onKeyPress},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"OnKeyDown",{get:function(){return this._onKeyDown},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"OnKeyUp",{get:function(){return this._onKeyUp},enumerable:!0,configurable:!0}),o.prototype.OnCommandPress=function(e,t){return this.UpdateCache(e,t,this._onPressCommands)},o.prototype.OnCommandDown=function(e,t){return this.UpdateCache(e,t,this._onDownCommands)},o.prototype.OnCommandUp=function(e,t){return this.UpdateCache(e,t,this._onUpCommands)},o.prototype.Dispose=function(){if(this._disposed)throw new Error("KeyboardHandler cannot be disposed more than once");for(var e in this._disposed=!0,this._onKeyDown.Dispose(),this._onKeyPress.Dispose(),this._onKeyUp.Dispose(),this._onDownCommands)this._onDownCommands[e].Dispose();for(var e in this._onDownCommands=null,this._onUpCommands)this._onUpCommands[e].Dispose();for(var e in this._onUpCommands=null,this._onPressCommands)this._onPressCommands[e].Dispose();this._onPressCommands=null,this.Unwire()},o.prototype.UpdateCache=function(e,t,n){var e=new a.Assets.KeyboardCommand(e,t),i=o._keyboardCommandIds++;return e.OnDispose.Bind(function(){delete n[i]}),n[i]=e},o.prototype.Wire=function(){this._keyPressWire=this.BuildKeyEvent(this._onPressCommands,this.OnKeyPress),this._keyDownWire=this.BuildKeyEvent(this._onDownCommands,this.OnKeyDown),this._keyUpWire=this.BuildKeyEvent(this._onUpCommands,this.OnKeyUp),document.addEventListener("keypress",this._keyPressWire,!1),document.addEventListener("keydown",this._keyDownWire,!1),document.addEventListener("keyup",this._keyUpWire,!1)},o.prototype.Unwire=function(){document.removeEventListener("keypress",this._keyPressWire,!1),document.removeEventListener("keydown",this._keyDownWire,!1),document.removeEventListener("keyup",this._keyUpWire,!1)},o.prototype.FocusingTextArea=function(e){var t;return e.target?t=e.target:e.srcElement&&(t=e.srcElement),"INPUT"===(t=3===t.nodeType?t.parentNode:t).tagName||"TEXTAREA"===t.tagName},o.prototype.BuildKeyEvent=function(o,r){var s=this;return function(e){var t,n=!0;if(!s.FocusingTextArea(e)){for(var i in t=new a.KeyboardCommandEvent(e),r.Trigger(t),o)t.Matches(o[i])&&(o[i].Action(),e.preventDefault(),n=!1);return n}}},o._keyboardCommandIds=0,a.KeyboardHandler=o}(e.Input||(e.Input={}));e.Input}(EndGate=EndGate||{}),function(e){!function(t){function e(e){this._disposed=!1,this.Mouse=new t.MouseHandler(e),this.Keyboard=new t.KeyboardHandler}e.prototype.Dispose=function(){if(this._disposed)throw new Error("MouseHandler cannot be disposed more than once");this._disposed=!0,this.Mouse.Dispose(),this.Keyboard.Dispose()},t.InputManager=e}(e.Input||(e.Input={}));e.Input}(EndGate=EndGate||{}),function(h){!function(e){function o(t,e,n,i,o,r,s){void 0===i&&(i=0),void 0===o&&(o=0),void 0===r&&(r=e),void 0===s&&(s=n);var a,u=this,l=void 0!==e;this._onLoaded=new h.EventHandler1,"string"==typeof t?(a=t,this._loaded=!1,this.Source=new Image,this._loadWire=function(e){u._loaded=!0,l||(u._size=new h.Size2d(u.Source.width,u.Source.height),u.ClipLocation=h.Vector2d.Zero,u.ClipSize=u._size.Clone()),u._onLoaded.Trigger(u)},this.Source.src=a,this._imageLocation=a,l?(this._size=new h.Size2d(e,n),this.ClipLocation=new h.Vector2d(i,o),this.ClipSize=new h.Size2d(r,s)):this.ClipSize=null):(r=i,s=o,i=e,o=n,this.Source=t,this._imageLocation=t.src,this._loaded=!1,this.Source.complete?(this._loadWire=function(e){u._loaded=!0,u._onLoaded.Trigger(u)},this._size=new h.Size2d(t.width,t.height)):this._loadWire=function(e){u._loaded=!0,u._onLoaded.Trigger(u),u._size=new h.Size2d(t.width,t.height)},this.ClipLocation=new h.Vector2d(i,o),this.ClipSize=new h.Size2d(r,s)),this.Source.complete?setTimeout(this._loadWire,0):this.Source.addEventListener("load",this._loadWire,!1)}Object.defineProperty(o.prototype,"OnLoaded",{get:function(){return this._onLoaded},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"Size",{get:function(){return this._size.Clone()},enumerable:!0,configurable:!0}),o.prototype.IsLoaded=function(){return this._loaded},o.prototype.Extract=function(e,t,n,i){return new o(this._imageLocation,this._size.Width,this._size.Height,e,t,n,i)},o.prototype.Dispose=function(){this.Source.removeEventListener("load",this._loadWire),this.Source=null,this._onLoaded.Dispose()},o.prototype.Clone=function(){return this.ClipSize?new o(this.Source,this.ClipLocation.X,this.ClipLocation.Y,this.ClipSize.Width,this.ClipSize.Height):new o(this.Source)},e.ImageSource=o}(h.Graphics||(h.Graphics={}));h.Graphics}(EndGate=EndGate||{}),function(e){!function(e){function t(e,t,n,i){void 0===t&&(t=100),void 0===n&&(n=!1),void 0===i&&(i="auto"),this.Repeat=e=void 0===e?!1:e,this.Volume=t,this.AutoPlay=n,this.Preload=i}t.prototype.Clone=function(){return new t(this.Repeat,this.Volume,this.AutoPlay,this.Preload)},t.Default=new t,e.AudioSettings=t}(e.Sound||(e.Sound={}));e.Sound}(EndGate=EndGate||{}),function(i){!function(n){var o={mp3:"audio/mpeg",ogg:"audio/ogg",wav:"audio/wav",aac:"audio/aac",m4a:"audio/x-m4a"};function e(e,t){void 0===t&&(t=n.AudioSettings.Default),this._disposed=!1,this._settings=t.Clone(),this._canPlayWires=[],e instanceof HTMLAudioElement?this._audio=e:(this._audio=document.createElement("audio"),this.SetAudioSource(e)),this.ApplySettings(),this._onComplete=new i.EventHandler1}Object.defineProperty(e.prototype,"OnComplete",{get:function(){return this._onComplete},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Volume",{get:function(){return this._settings.Volume},set:function(e){this._settings.Volume=e,this._audio.volume=Math.max(Math.min(e/100,1),0)},enumerable:!0,configurable:!0}),e.prototype.IsPlaying=function(){return!this._audio.paused},e.prototype.IsComplete=function(){return this._audio.ended},e.prototype.Play=function(){var e,t=this;0===this._audio.readyState?(this._canPlayWires.push(e=function(){t._audio.play()}),this._audio.addEventListener("canplay",e,!0)):this._audio.play()},e.prototype.Pause=function(){this._audio.pause()},e.prototype.Seek=function(e){var t,n=this;0===this._audio.readyState?(this._canPlayWires.push(t=function(){n._audio.currentTime=e}),this._audio.addEventListener("canplay",t,!0)):this._audio.currentTime=e},e.prototype.Stop=function(){this.Seek(0),this._audio.pause()},e.prototype.Dispose=function(){if(this._disposed)throw new Error("Cannot dispose AudioClip more than once.");this._disposed=!0,this._onComplete.Dispose();for(var e=0;e<this._canPlayWires.length;e++)this._audio.removeEventListener("canplay",this._canPlayWires[e],!0);this._audio.removeEventListener("ended",this._endedWire,!0),this._audio=null,this._settings=null},e.prototype.SetAudioSource=function(e){var t,n;e instanceof Array||(e=[e]);for(var i=0;i<e.length;i++)(t=document.createElement("source")).src=e[i],void 0!==(n=o[e[i].split(".").pop()])&&(t.type=n),this._audio.appendChild(t)},e.prototype.ApplySettings=function(){var t=this;this._audio.loop=this._settings.Repeat,this._audio.autoplay=this._settings.AutoPlay,this._audio.preload=this._settings.Preload,this.Volume=this._settings.Volume,this._endedWire=function(e){t.OnComplete.Trigger(e)},this._audio.addEventListener("ended",this._endedWire,!0)},n.AudioClip=e}(i.Sound||(i.Sound={}));i.Sound}(EndGate=EndGate||{}),function(e){!function(t){function e(e){e instanceof Array?this._source=e:(this._source=[],this._source.push(e))}e.prototype.BuildClip=function(e){return void 0===e&&(e=t.AudioSettings.Default),new t.AudioClip(this._source,e)},e.prototype.Play=function(e){void 0===e&&(e=t.AudioSettings.Default);e=new t.AudioClip(this._source,e);return e.Play(),e},t.AudioPlayer=e}(e.Sound||(e.Sound={}));e.Sound}(EndGate=EndGate||{}),function(o){!function(e){function t(){this._images={},this._audioPlayers={}}t.prototype.LoadImage=function(e,t,n,i){t=new o.Graphics.ImageSource(t,n,i);return(this._images[e]=t).Clone()},t.prototype.GetImage=function(e){if(this._images[e])return this._images[e].Clone();throw new Error("Image with name '"+e+"' was not found.")},t.prototype.UnloadImage=function(e){return!!this._images[e]&&(delete this._images[e],!0)},t.prototype.LoadAudio=function(e,t){return this._audioPlayers[e]=new o.Sound.AudioPlayer(t),this._audioPlayers[e]},t.prototype.GetAudio=function(e){if(this._audioPlayers[e])return this._audioPlayers[e];throw new Error("Audio with name '"+e+"' was not found.")},t.prototype.UnloadAudio=function(e){var t=this._audioPlayers[e];return delete this._audioPlayers[e],t},e.ContentManager=t}(o.Content||(o.Content={}));o.Content}(EndGate=EndGate||{}),function(i){function o(e){var t=this;this._type="Game";var n=i.Collision.CollisionConfiguration._DefaultMinQuadTreeNodeSize;this._updateRequired=!0,this._gameTime=new i.GameTime,this._ID=o._gameIds++,this.Scene=new i.Rendering.Scene2d(function(e){t.Draw(e)},e),this.Input=new i.Input.InputManager(this.Scene.DrawArea),this.Content=new i.Content.ContentManager,(e=this.Scene.Camera.Size).Width%n.Width!=0&&(e=new i.Size2d(e.Width%n.Width+e.Width)),this.Configuration=new i.GameConfiguration(GameRunnerInstance.Register(this),e),this.CollisionManager=new i.Collision.CollisionManager(this.Configuration.CollisionConfiguration),this.Configuration.CollisionConfiguration._OnChange.Bind(function(){t.CollisionManager=new i.Collision.CollisionManager(t.Configuration.CollisionConfiguration)}),this._PrepareLoadContent()}o.prototype._PrepareUpdate=function(){this._gameTime.Update(),this.Update(this._gameTime),this.CollisionManager.Update(this._gameTime),this._updateRequired=!1},o.prototype._PrepareLoadContent=function(){this.LoadContent()},o.prototype.LoadContent=function(){},o.prototype.Update=function(e){},o.prototype._PrepareDraw=function(){this.Configuration.DrawOnlyAfterUpdate&&this._updateRequired||(this.Scene.Draw(),this._updateRequired=!0)},o.prototype.Draw=function(e){},o.prototype.Dispose=function(){this.Scene.Dispose(),this.CollisionManager.Dispose(),this.Input.Dispose(),GameRunnerInstance.Unregister(this)},o._gameIds=0,i.Game=o}(EndGate=EndGate||{}),function(e){var t=e.MovementControllers||(e.MovementControllers={});(t.Assets||(t.Assets={})).LinearDirections=function(){this.Left=!1,this.Right=!1,this.Up=!1,this.Down=!1},t.Assets,e.MovementControllers}(EndGate=EndGate||{}),function(n){!function(e){function t(e){this.Position=0<e.length?e[0].Position:n.Vector2d.Zero,this.Velocity=n.Vector2d.Zero,this.Rotation=0,this._frozen=!1,this._moveables=e}t.prototype.Freeze=function(){this._frozen=!0},t.prototype.Thaw=function(){this._frozen=!1},t.prototype.IsMoving=function(){return!this._frozen&&!this.Velocity.IsZero()},t.prototype.Update=function(e){for(var t=0;t<this._moveables.length;t++)this._moveables[t].Position=this.Position,this._moveables[t].Rotation=this.Rotation},e.MovementController=t}(n.MovementControllers||(n.MovementControllers={}));n.MovementControllers}(EndGate=EndGate||{}),function(r){function e(e,t,n,i){void 0===n&&(n=!0),void 0===i&&(i=!0);var o=this;a.call(this,e),this._moveSpeed=t,this._moving=new s.Assets.LinearDirections,this.OnMove=new r.EventHandler1,this._rotationUpdater=new r._.Utilities.NoopTripInvoker(function(){o.UpdateRotation()},n),this._velocityUpdater=i?this.UpdateVelocityWithMultiDirection:this.UpdateVelocityNoMultiDirection}var s,a;s=r.MovementControllers||(r.MovementControllers={}),a=s.MovementController,__extends(e,a),e.prototype.IsMovingInDirection=function(e){return this._moving[e]||!1},e.prototype.StartMoving=function(e){this.Move(e,!0)},e.prototype.StopMoving=function(e){this.Move(e,!1)},e.prototype.MoveSpeed=function(e){return void 0!==e&&(this._moveSpeed=e,this._velocityUpdater()),this._moveSpeed},e.prototype.Update=function(e){this._frozen||(this.Position=this.Position.Add(this.Velocity.Multiply(e.Elapsed.Seconds)),a.prototype.Update.call(this,e))},e.prototype.Move=function(e,t){if(void 0===this._moving[e])throw new Error(e+" is an unknown direction.");this._moving[e]=t,this._velocityUpdater(),this._rotationUpdater.Invoke(),this.OnMove.Trigger({Direction:e,StartMoving:t})},e.prototype.UpdateVelocityNoMultiDirection=function(){var e=r.Vector2d.Zero;e.IsZero()&&(this._moving.Up&&(e.Y-=this._moveSpeed),this._moving.Down&&(e.Y+=this._moveSpeed),0===e.Y&&(this._moving.Left&&(e.X-=this._moveSpeed),this._moving.Right&&(e.X+=this._moveSpeed))),this.Velocity=e},e.prototype.UpdateVelocityWithMultiDirection=function(){var e=r.Vector2d.Zero;this._moving.Up&&(e.Y-=this._moveSpeed),this._moving.Down&&(e.Y+=this._moveSpeed),this._moving.Left&&(e.X-=this._moveSpeed),this._moving.Right&&(e.X+=this._moveSpeed),this.Velocity=e},e.prototype.UpdateRotation=function(){this.Velocity.IsZero()||(this.Rotation=Math.atan2(this.Velocity.Y,this.Velocity.X))},s.LinearMovementController=e,r.MovementControllers}(EndGate=EndGate||{}),function(s){!function(e){function t(e,t,n,i,o,r){void 0===n&&(n=["w","Up"]),void 0===i&&(i=["d","Right"]),void 0===o&&(o=["s","Down"]),void 0===r&&(r=["a","Left"]),this._keyboard=e,this._onMove=t,this._directions=new s.MovementControllers.Assets.LinearDirections,this.BindKeys(n,"OnCommandDown","Up",!0),this.BindKeys(i,"OnCommandDown","Right",!0),this.BindKeys(o,"OnCommandDown","Down",!0),this.BindKeys(r,"OnCommandDown","Left",!0),this.BindKeys(n,"OnCommandUp","Up",!1),this.BindKeys(i,"OnCommandUp","Right",!1),this.BindKeys(o,"OnCommandUp","Down",!1),this.BindKeys(r,"OnCommandUp","Left",!1)}t.prototype.BindKeys=function(e,t,n,i){for(var o=this,r=0;r<e.length;r++)this._keyboard[t](e[r],function(){o._directions[n]!=i&&(o._directions[n]=i,o._onMove(n,i))})},e.DirectionalInputController=t}(s.InputControllers||(s.InputControllers={}));s.InputControllers}(EndGate=EndGate||{}),function(r){!function(e){function o(e,t,n,i){this._type="Color",this._cached=void 0,this._onChange=new r.EventHandler1,"string"==typeof e&&0<e.length?this.InitializeColorFromString(e):(this.A=void 0===i?1:i,this.R=e,this.G=t,this.B=n)}Object.defineProperty(o.prototype,"OnChange",{get:function(){return this._onChange},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"R",{get:function(){return this._r},set:function(e){this._cached=void 0,this._r=Math.round(Math.min(Math.max(e,0),255)),this._onChange.Trigger(this)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"G",{get:function(){return this._g},set:function(e){this._cached=void 0,this._g=Math.round(Math.min(Math.max(e,0),255)),this._onChange.Trigger(this)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"B",{get:function(){return this._b},set:function(e){this._cached=void 0,this._b=Math.round(Math.min(Math.max(e,0),255)),this._onChange.Trigger(this)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"A",{get:function(){return this._a},set:function(e){this._cached=void 0,this._a=Math.min(Math.max(e,0),1),this._onChange.Trigger(this)},enumerable:!0,configurable:!0}),o.FromRGB=function(e,t,n){return new o(e,t,n)},o.FromRGBA=function(e,t,n,i){return new o(e,t,n,i)},o.FromARGB=function(e,t,n,i){return new o(t,n,i,e)},o.FromHex=function(e){return new o(e)},o.FromName=function(e){return new o(e)},o.ConvertShortHexToLong=function(e){return 3===e.length&&(e+="f"),e=4===e.length?e.replace(o.RgbaHexRegExp,function(e,t,n,i,o){return n+n+i+i+o+o+t+t}):e},o.prototype.InitializeColorFromString=function(e){var e=this.NamedColorToHex(e),t=null,t="string"==typeof e?this.CreateColorObjectFromString(e):e;this.A=t.A,this.B=t.B,this.R=t.R,this.G=t.G},o.prototype.CreateColorObjectFromString=function(e){return"#"===e.charAt(0)&&(e=e.substr(1)),6===(e=o.ConvertShortHexToLong(e)).length&&(e+="ff"),8===e.length?this.ParseAlphaHex(e):this.ParseRGB(e)},o.prototype.ParseRGB=function(e){var t=o.RgbRegExp.exec(e);if(t)switch(t[1]){case"rgb":return new o(parseInt(t[2]),parseInt(t[3]),parseInt(t[4]));case"argb":return new o(parseInt(t[3]),parseInt(t[4]),parseInt(t[5]),parseFloat(t[2]));case"rgba":return new o(parseInt(t[2]),parseInt(t[3]),parseInt(t[4]),parseFloat(t[5]))}return o.Magenta},o.prototype.ParseAlphaHex=function(e){return new o(parseInt(e.charAt(0)+e.charAt(1),16),parseInt(e.charAt(2)+e.charAt(3),16),parseInt(e.charAt(4)+e.charAt(5),16),parseInt(e.charAt(6)+e.charAt(7),16)/255)},o.prototype.ParseHex=function(e){return new o(parseInt(e.charAt(0)+e.charAt(1),16),parseInt(e.charAt(2)+e.charAt(3),16),parseInt(e.charAt(4)+e.charAt(5),16))},o.prototype.NamedColorToHex=function(e){return"#"!==e.substring(0,1)&&void 0!==o._namedColors[e.toLowerCase()]?o._namedColors[e.toLowerCase()]:e},Object.defineProperty(o,"Transparent",{get:function(){return o._namedColors.transparent.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"AliceBlue",{get:function(){return o._namedColors.aliceblue.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"AntiqueWhite",{get:function(){return o._namedColors.antiquewhite.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Aqua",{get:function(){return o._namedColors.aqua.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Aquamarine",{get:function(){return o._namedColors.aquamarine.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Azure",{get:function(){return o._namedColors.azure.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Beige",{get:function(){return o._namedColors.beige.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Bisque",{get:function(){return o._namedColors.bisque.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Black",{get:function(){return o._namedColors.black.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"BlanchedAlmond",{get:function(){return o._namedColors.blanchedalmond.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Blue",{get:function(){return o._namedColors.blue.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"BlueViolet",{get:function(){return o._namedColors.blueviolet.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Brown",{get:function(){return o._namedColors.brown.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"BurlyWood",{get:function(){return o._namedColors.burlywood.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"CadetBlue",{get:function(){return o._namedColors.cadetblue.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Chartreuse",{get:function(){return o._namedColors.chartreuse.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Chocolate",{get:function(){return o._namedColors.chocolate.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Coral",{get:function(){return o._namedColors.coral.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"CornflowerBlue",{get:function(){return o._namedColors.cornflowerblue.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Cornsilk",{get:function(){return o._namedColors.cornsilk.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Crimson",{get:function(){return o._namedColors.crimson.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Cyan",{get:function(){return o._namedColors.cyan.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"DarkBlue",{get:function(){return o._namedColors.darkblue.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"DarkCyan",{get:function(){return o._namedColors.darkcyan.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"DarkGoldenRod",{get:function(){return o._namedColors.darkgoldenrod.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"DarkGray",{get:function(){return o._namedColors.darkgray.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"DarkGreen",{get:function(){return o._namedColors.darkgreen.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"DarkKhaki",{get:function(){return o._namedColors.darkkhaki.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"DarkMagenta",{get:function(){return o._namedColors.darkmagenta.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"DarkOliveGreen",{get:function(){return o._namedColors.darkolivegreen.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"DarkOrange",{get:function(){return o._namedColors.darkorange.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"DarkOrchid",{get:function(){return o._namedColors.darkorchid.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"DarkRed",{get:function(){return o._namedColors.darkred.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"DarkSalmon",{get:function(){return o._namedColors.darksalmon.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"DarkSeaGreen",{get:function(){return o._namedColors.darkseagreen.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"DarkSlateBlue",{get:function(){return o._namedColors.darkslateblue.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"DarkSlateGray",{get:function(){return o._namedColors.darkslategray.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"DarkTurquoise",{get:function(){return o._namedColors.darkturquoise.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"DarkViolet",{get:function(){return o._namedColors.darkviolet.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"DeepPink",{get:function(){return o._namedColors.deeppink.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"DeepSkyBlue",{get:function(){return o._namedColors.deepskyblue.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"DimGray",{get:function(){return o._namedColors.dimgray.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"DodgerBlue",{get:function(){return o._namedColors.dodgerblue.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"FireBrick",{get:function(){return o._namedColors.firebrick.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"FloralWhite",{get:function(){return o._namedColors.floralwhite.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"ForestGreen",{get:function(){return o._namedColors.forestgreen.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Fuchsia",{get:function(){return o._namedColors.fuchsia.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Gainsboro",{get:function(){return o._namedColors.gainsboro.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"GhostWhite",{get:function(){return o._namedColors.ghostwhite.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Gold",{get:function(){return o._namedColors.gold.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"GoldenRod",{get:function(){return o._namedColors.goldenrod.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Gray",{get:function(){return o._namedColors.gray.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Green",{get:function(){return o._namedColors.green.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"GreenYellow",{get:function(){return o._namedColors.greenyellow.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"HoneyDew",{get:function(){return o._namedColors.honeydew.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"HotPink",{get:function(){return o._namedColors.hotpink.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"IndianRed",{get:function(){return o._namedColors.indianred.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Indigo",{get:function(){return o._namedColors.indigo.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Ivory",{get:function(){return o._namedColors.ivory.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Khaki",{get:function(){return o._namedColors.khaki.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Lavender",{get:function(){return o._namedColors.lavender.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"LavenderBlush",{get:function(){return o._namedColors.lavenderblush.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"LawnGreen",{get:function(){return o._namedColors.lawngreen.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"LemonChiffon",{get:function(){return o._namedColors.lemonchiffon.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"LightBlue",{get:function(){return o._namedColors.lightblue.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"LightCoral",{get:function(){return o._namedColors.lightcoral.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"LightCyan",{get:function(){return o._namedColors.lightcyan.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"LightGoldenRodYellow",{get:function(){return o._namedColors.lightgoldenrodyellow.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"LightGray",{get:function(){return o._namedColors.lightgray.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"LightGrey",{get:function(){return o._namedColors.lightgrey.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"LightGreen",{get:function(){return o._namedColors.lightgreen.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"LightPink",{get:function(){return o._namedColors.lightpink.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"LightSalmon",{get:function(){return o._namedColors.lightsalmon.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"LightSeaGreen",{get:function(){return o._namedColors.lightseagreen.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"LightSkyBlue",{get:function(){return o._namedColors.lightskyblue.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"LightSlateGray",{get:function(){return o._namedColors.lightslategray.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"LightSteelBlue",{get:function(){return o._namedColors.lightsteelblue.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"LightYellow",{get:function(){return o._namedColors.lightyellow.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Lime",{get:function(){return o._namedColors.lime.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"LimeGreen",{get:function(){return o._namedColors.limegreen.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Linen",{get:function(){return o._namedColors.linen.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Magenta",{get:function(){return o._namedColors.magenta.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Maroon",{get:function(){return o._namedColors.maroon.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"MediumAquaMarine",{get:function(){return o._namedColors.mediumaquamarine.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"MediumBlue",{get:function(){return o._namedColors.mediumblue.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"MediumOrchid",{get:function(){return o._namedColors.mediumorchid.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"MediumPurple",{get:function(){return o._namedColors.mediumpurple.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"MediumSeaGreen",{get:function(){return o._namedColors.mediumseagreen.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"MediumSlateBlue",{get:function(){return o._namedColors.mediumslateblue.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"MediumSpringGreen",{get:function(){return o._namedColors.mediumspringgreen.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"MediumTurquoise",{get:function(){return o._namedColors.mediumturquoise.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"MediumVioletRed",{get:function(){return o._namedColors.mediumvioletred.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"MidnightBlue",{get:function(){return o._namedColors.midnightblue.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"MintCream",{get:function(){return o._namedColors.mintcream.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"MistyRose",{get:function(){return o._namedColors.mistyrose.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Moccasin",{get:function(){return o._namedColors.moccasin.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"NavajoWhite",{get:function(){return o._namedColors.navajowhite.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Navy",{get:function(){return o._namedColors.navy.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"OldLace",{get:function(){return o._namedColors.oldlace.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Olive",{get:function(){return o._namedColors.olive.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"OliveDrab",{get:function(){return o._namedColors.olivedrab.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Orange",{get:function(){return o._namedColors.orange.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"OrangeRed",{get:function(){return o._namedColors.orangered.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Orchid",{get:function(){return o._namedColors.orchid.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"PaleGoldenRod",{get:function(){return o._namedColors.palegoldenrod.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"PaleGreen",{get:function(){return o._namedColors.palegreen.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"PaleTurquoise",{get:function(){return o._namedColors.paleturquoise.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"PaleVioletRed",{get:function(){return o._namedColors.palevioletred.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"PapayaWhip",{get:function(){return o._namedColors.papayawhip.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"PeachPuff",{get:function(){return o._namedColors.peachpuff.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Peru",{get:function(){return o._namedColors.peru.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Pink",{get:function(){return o._namedColors.pink.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Plum",{get:function(){return o._namedColors.plum.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"PowderBlue",{get:function(){return o._namedColors.powderblue.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Purple",{get:function(){return o._namedColors.purple.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Red",{get:function(){return o._namedColors.red.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"RosyBrown",{get:function(){return o._namedColors.rosybrown.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"RoyalBlue",{get:function(){return o._namedColors.royalblue.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"SaddleBrown",{get:function(){return o._namedColors.saddlebrown.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Salmon",{get:function(){return o._namedColors.salmon.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"SandyBrown",{get:function(){return o._namedColors.sandybrown.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"SeaGreen",{get:function(){return o._namedColors.seagreen.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"SeaShell",{get:function(){return o._namedColors.seashell.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Sienna",{get:function(){return o._namedColors.sienna.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Silver",{get:function(){return o._namedColors.silver.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"SkyBlue",{get:function(){return o._namedColors.skyblue.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"SlateBlue",{get:function(){return o._namedColors.slateblue.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"SlateGray",{get:function(){return o._namedColors.slategray.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Snow",{get:function(){return o._namedColors.snow.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"SpringGreen",{get:function(){return o._namedColors.springgreen.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"SteelBlue",{get:function(){return o._namedColors.steelblue.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Tan",{get:function(){return o._namedColors.tan.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Teal",{get:function(){return o._namedColors.teal.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Thistle",{get:function(){return o._namedColors.thistle.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Tomato",{get:function(){return o._namedColors.tomato.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Turquoise",{get:function(){return o._namedColors.turquoise.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Violet",{get:function(){return o._namedColors.violet.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Wheat",{get:function(){return o._namedColors.wheat.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"White",{get:function(){return o._namedColors.white.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"WhiteSmoke",{get:function(){return o._namedColors.whitesmoke.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Yellow",{get:function(){return o._namedColors.yellow.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"YellowGreen",{get:function(){return o._namedColors.yellowgreen.Clone()},enumerable:!0,configurable:!0}),o.prototype.Clone=function(){return new o(this.R,this.G,this.B,this.A)},o.prototype.Dispose=function(){this._onChange.Dispose()},o.prototype.toString=function(){return void 0===this._cached&&(this._cached="rgba("+this.R+","+this.G+","+this.B+","+this.A+")"),this._cached},o.RgbaHexRegExp=/^([a-f\d])([a-f\d])([a-f\d])([a-f\d])$/i,o.RgbRegExp=/^(argb|rgb|rgba)\s*\(\s*([\d+(\.\d+)]{0,3})\s*,\s*([\d]{0,3})\s*,\s*([\d]{0,3})\s*(?:,\s*([\d+(\.\d+)]{0,3})\s*)?\s*\)$/i,o.RgbaRegExp=/^([a-f\d])([a-f\d])([a-f\d])$/i,o._namedColors={transparent:new o(255,255,255,0),aliceblue:new o("#f0f8ff"),antiquewhite:new o("#faebd7"),aqua:new o("#00ffff"),aquamarine:new o("#7fffd4"),azure:new o("#f0ffff"),beige:new o("#f5f5dc"),bisque:new o("#ffe4c4"),black:new o("#000000"),blanchedalmond:new o("#ffebcd"),blue:new o("#0000ff"),blueviolet:new o("#8a2be2"),brown:new o("#a52a2a"),burlywood:new o("#deb887"),cadetblue:new o("#5f9ea0"),chartreuse:new o("#7fff00"),chocolate:new o("#d2691e"),coral:new o("#ff7f50"),cornflowerblue:new o("#6495ed"),cornsilk:new o("#fff8dc"),crimson:new o("#dc143c"),cyan:new o("#00ffff"),darkblue:new o("#00008b"),darkcyan:new o("#008b8b"),darkgoldenrod:new o("#b8860b"),darkgray:new o("#a9a9a9"),darkgreen:new o("#006400"),darkkhaki:new o("#bdb76b"),darkmagenta:new o("#8b008b"),darkolivegreen:new o("#556b2f"),darkorange:new o("#ff8c00"),darkorchid:new o("#9932cc"),darkred:new o("#8b0000"),darksalmon:new o("#e9967a"),darkseagreen:new o("#8fbc8f"),darkslateblue:new o("#483d8b"),darkslategray:new o("#2f4f4f"),darkturquoise:new o("#00ced1"),darkviolet:new o("#9400d3"),deeppink:new o("#ff1493"),deepskyblue:new o("#00bfff"),dimgray:new o("#696969"),dodgerblue:new o("#1e90ff"),firebrick:new o("#b22222"),floralwhite:new o("#fffaf0"),forestgreen:new o("#228b22"),fuchsia:new o("#ff00ff"),gainsboro:new o("#dcdcdc"),ghostwhite:new o("#f8f8ff"),gold:new o("#ffd700"),goldenrod:new o("#daa520"),gray:new o("#808080"),green:new o("#008000"),greenyellow:new o("#adff2f"),honeydew:new o("#f0fff0"),hotpink:new o("#ff69b4"),indianred:new o("#cd5c5c"),indigo:new o("#4b0082"),ivory:new o("#fffff0"),khaki:new o("#f0e68c"),lavender:new o("#e6e6fa"),lavenderblush:new o("#fff0f5"),lawngreen:new o("#7cfc00"),lemonchiffon:new o("#fffacd"),lightblue:new o("#add8e6"),lightcoral:new o("#f08080"),lightcyan:new o("#e0ffff"),lightgoldenrodyellow:new o("#fafad2"),lightgray:new o("#d3d3d3"),lightgrey:new o("#d3d3d3"),lightgreen:new o("#90ee90"),lightpink:new o("#ffb6c1"),lightsalmon:new o("#ffa07a"),lightseagreen:new o("#20b2aa"),lightskyblue:new o("#87cefa"),lightslategray:new o("#778899"),lightsteelblue:new o("#b0c4de"),lightyellow:new o("#ffffe0"),lime:new o("#00ff00"),limegreen:new o("#32cd32"),linen:new o("#faf0e6"),magenta:new o("#ff00ff"),maroon:new o("#800000"),mediumaquamarine:new o("#66cdaa"),mediumblue:new o("#0000cd"),mediumorchid:new o("#ba55d3"),mediumpurple:new o("#9370d8"),mediumseagreen:new o("#3cb371"),mediumslateblue:new o("#7b68ee"),mediumspringgreen:new o("#00fa9a"),mediumturquoise:new o("#48d1cc"),mediumvioletred:new o("#c71585"),midnightblue:new o("#191970"),mintcream:new o("#f5fffa"),mistyrose:new o("#ffe4e1"),moccasin:new o("#ffe4b5"),navajowhite:new o("#ffdead"),navy:new o("#000080"),oldlace:new o("#fdf5e6"),olive:new o("#808000"),olivedrab:new o("#6b8e23"),orange:new o("#ffa500"),orangered:new o("#ff4500"),orchid:new o("#da70d6"),palegoldenrod:new o("#eee8aa"),palegreen:new o("#98fb98"),paleturquoise:new o("#afeeee"),palevioletred:new o("#d87093"),papayawhip:new o("#ffefd5"),peachpuff:new o("#ffdab9"),peru:new o("#cd853f"),pink:new o("#ffc0cb"),plum:new o("#dda0dd"),powderblue:new o("#b0e0e6"),purple:new o("#800080"),red:new o("#ff0000"),rosybrown:new o("#bc8f8f"),royalblue:new o("#4169e1"),saddlebrown:new o("#8b4513"),salmon:new o("#fa8072"),sandybrown:new o("#f4a460"),seagreen:new o("#2e8b57"),seashell:new o("#fff5ee"),sienna:new o("#a0522d"),silver:new o("#c0c0c0"),skyblue:new o("#87ceeb"),slateblue:new o("#6a5acd"),slategray:new o("#708090"),snow:new o("#fffafa"),springgreen:new o("#00ff7f"),steelblue:new o("#4682b4"),tan:new o("#d2b48c"),teal:new o("#008080"),thistle:new o("#d8bfd8"),tomato:new o("#ff6347"),turquoise:new o("#40e0d0"),violet:new o("#ee82ee"),wheat:new o("#f5deb3"),white:new o("#ffffff"),whitesmoke:new o("#f5f5f5"),yellow:new o("#ffff00"),yellowgreen:new o("#9acd32")},e.Color=o}(r.Graphics||(r.Graphics={}));r.Graphics}(EndGate=EndGate||{}),function(e){function t(e,t){var n=this;o.call(this,e),this._type="Shape",this._fillChangeWire=function(e){n._State.FillStyle=e.toString()},this._strokeChangeWire=function(e){n._State.StrokeStyle=e.toString()},this._shadowChangeWire=function(e){n._State.ShadowColor=e.toString()},this.ShadowColor=this._shadowColor=i.Color.Black,this.BorderColor=this._strokeStyle=i.Color.Black,void 0!==t?("string"==typeof t&&(t=new i.Color(t)),this.Color=this._fillStyle=t):this.Color=this._fillStyle=i.Color.Black}var i,o;i=e.Graphics||(e.Graphics={}),o=i.Graphic2d,__extends(t,o),Object.defineProperty(t.prototype,"Color",{get:function(){return this._fillStyle},set:function(e){"string"==typeof e&&(e=new i.Color(e)),this._fillStyle.OnChange.Unbind(this._fillChangeWire),this._fillStyle=e,this._fillStyle.OnChange.Bind(this._fillChangeWire),this._fillChangeWire(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"BorderThickness",{get:function(){return this._State.LineWidth},set:function(e){this._State.LineWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"BorderColor",{get:function(){return this._strokeStyle},set:function(e){"string"==typeof e&&(e=new i.Color(e)),this._strokeStyle.OnChange.Unbind(this._strokeChangeWire),this._strokeStyle=e,this._strokeStyle.OnChange.Bind(this._strokeChangeWire),this._strokeChangeWire(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ShadowColor",{get:function(){return this._shadowColor},set:function(e){"string"==typeof e&&(e=new i.Color(e)),this._shadowColor.OnChange.Unbind(this._shadowChangeWire),this._shadowColor=e,this._shadowColor.OnChange.Bind(this._shadowChangeWire),this._shadowChangeWire(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ShadowX",{get:function(){return this._State.ShadowOffsetX},set:function(e){this._State.ShadowOffsetX=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ShadowY",{get:function(){return this._State.ShadowOffsetY},set:function(e){this._State.ShadowOffsetY=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ShadowBlur",{get:function(){return this._State.ShadowBlur},set:function(e){this._State.ShadowBlur=e},enumerable:!0,configurable:!0}),t.prototype.Border=function(e,t){this.BorderThickness=e,this.BorderColor=t},t.prototype.Shadow=function(e,t,n,i){this.ShadowX=e,this.ShadowY=t,this.ShadowColor=n,this.ShadowBlur=i},t.prototype._StartDraw=function(e){o.prototype._StartDraw.call(this,e),e.beginPath()},t.prototype._EndDraw=function(e){e.fill(),0<this._State.LineWidth?e.stroke():e.closePath(),o.prototype._EndDraw.call(this,e)},t.prototype._BuildPath=function(e){},t.prototype.Draw=function(e){this._StartDraw(e),this._BuildPath(e),this._EndDraw(e)},t.prototype.Dispose=function(){o.prototype.Dispose.call(this),this._fillStyle.OnChange.Unbind(this._fillChangeWire),this._strokeStyle.OnChange.Unbind(this._strokeChangeWire),this._shadowColor.OnChange.Unbind(this._shadowChangeWire)},t.prototype._Clone=function(e){e.Border(this.BorderThickness,this.BorderColor.Clone()),e.Shadow(this.ShadowX,this.ShadowY,this.ShadowColor.Clone(),this.ShadowBlur),o.prototype._Clone.call(this,e)},i.Shape=t,e.Graphics}(EndGate=EndGate||{}),function(e){var t,n,i;t=e.Graphics||(e.Graphics={}),n=t.Assets||(t.Assets={}),(i=n.FontFamily||(n.FontFamily={}))[i.Antiqua=0]="Antiqua",i[i.Arial=1]="Arial",i[i.Avqest=2]="Avqest",i[i.Blackletter=3]="Blackletter",i[i.Calibri=4]="Calibri",i[i.ComicSans=5]="ComicSans",i[i.Courier=6]="Courier",i[i.Decorative=7]="Decorative",i[i.Fraktur=8]="Fraktur",i[i.Frosty=9]="Frosty",i[i.Garamond=10]="Garamond",i[i.Georgia=11]="Georgia",i[i.Helvetica=12]="Helvetica",i[i.Impact=13]="Impact",i[i.Minion=14]="Minion",i[i.Modern=15]="Modern",i[i.Monospace=16]="Monospace",i[i.Palatino=17]="Palatino",i[i.Roman=18]="Roman",i[i.Script=19]="Script",i[i.Swiss=20]="Swiss",i[i.TimesNewRoman=21]="TimesNewRoman",i[i.Verdana=22]="Verdana",n.FontFamily,t.Assets,e.Graphics}(EndGate=EndGate||{}),function(e){var t,n,i;t=e.Graphics||(e.Graphics={}),n=t.Assets||(t.Assets={}),(i=n.FontVariant||(n.FontVariant={}))[i.Normal=0]="Normal",i[i.SmallCaps=1]="SmallCaps",n.FontVariant,t.Assets,e.Graphics}(EndGate=EndGate||{}),function(e){var t,n,i;t=e.Graphics||(e.Graphics={}),n=t.Assets||(t.Assets={}),(i=n.FontStyle||(n.FontStyle={}))[i.Normal=0]="Normal",i[i.Italic=1]="Italic",i[i.Oblique=2]="Oblique",n.FontStyle,t.Assets,e.Graphics}(EndGate=EndGate||{}),function(e){var t=e.Graphics||(e.Graphics={});(function(t){function e(){this._cachedState={fontSize:"10px",fontFamily:t.FontFamily.TimesNewRoman,fontVariant:t.FontVariant.Normal,fontWeight:"",fontStyle:t.FontStyle.Normal},this._refreshCache=!0,this._BuildFont()}Object.defineProperty(e.prototype,"FontSize",{get:function(){return this._cachedState.fontSize},set:function(e){this._refreshCache=!0,this._cachedState.fontSize=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"FontFamily",{get:function(){return this._cachedState.fontFamily},set:function(e){this._refreshCache=!0,this._cachedState.fontFamily=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"FontVariant",{get:function(){return this._cachedState.fontVariant},set:function(e){this._refreshCache=!0,this._cachedState.fontVariant=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"FontWeight",{get:function(){return this._cachedState.fontWeight},set:function(e){this._refreshCache=!0,this._cachedState.fontWeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"FontStyle",{get:function(){return this._cachedState.fontStyle},set:function(e){this._refreshCache=!0,this._cachedState.fontStyle=e},enumerable:!0,configurable:!0}),e.prototype._BuildFont=function(){var e;return this._refreshCache&&(e=this._cachedState.fontWeight+" "+t.FontStyle[this._cachedState.fontStyle].replace("Normal","")+" "+t.FontVariant[this._cachedState.fontVariant].replace("Normal","")+" "+this._cachedState.fontSize,void 0!==this._cachedState.fontFamily&&(e+=" "+t.FontFamily[this._cachedState.fontFamily]),this._cachedFont=e.replace(/^\s\s*/,"").replace(/\s\s*$/,""),this._refreshCache=!1),this._cachedFont},t.FontSettings=e})(t.Assets||(t.Assets={})),t.Assets,e.Graphics}(EndGate=EndGate||{}),function(o){function t(e,t,n,i){void 0===i&&(i=r.Color.Black),s.call(this,new o.Vector2d(e,t),i),this._type="Text2d",this._text=n,this._drawBounds=new o.Bounds.BoundingRectangle(this.Position,o.Size2d.One),this._recalculateBoundsSize=!0,this._fontSettings=new r.Assets.FontSettings,this.Align="center",this.Baseline="middle"}var r,s;r=o.Graphics||(o.Graphics={}),s=r.Shape,__extends(t,s),Object.defineProperty(t.prototype,"Align",{get:function(){return this._State.TextAlign},set:function(e){this._State.TextAlign=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Baseline",{get:function(){return this._State.TextBaseline},set:function(e){this._State.TextBaseline=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FontSettings",{get:function(){return this._recalculateBoundsSize=!0,this._fontSettings},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Text",{get:function(){return this._text},set:function(e){this._recalculateBoundsSize=!0,this._text=e},enumerable:!0,configurable:!0}),t.prototype._StartDraw=function(e){e.save(),this._State.SetContextState(e),e.translate(this.Position.X,this.Position.Y),0!==this.Rotation&&e.rotate(this.Rotation)},t.prototype._EndDraw=function(e){for(var t=this.GetChildren(),n=0;n<t.length;n++)t[n].Visible&&t[n].Draw(e);e.restore()},t.prototype.Draw=function(e){var t;this._State.Font=this._fontSettings._BuildFont(),this._StartDraw(e),e.fillText(this._text,0,0),0<this._State.LineWidth&&e.strokeText(this._text,0,0),this._recalculateBoundsSize&&(this._recalculateBoundsSize=!1,t=e.measureText(this._text),this._drawBounds.Size.Width=t.width,this._drawBounds.Size.Height=1.5*parseInt(this._fontSettings.FontSize)),this._EndDraw(e)},t.prototype.GetDrawBounds=function(){return this._drawBounds.Rotation=this.Rotation,this._drawBounds.Position=this.Position,this._drawBounds},t.prototype.Scale=function(e){var t=parseInt(this.FontSettings.FontSize);this.FontSettings.FontSize=this.FontSettings.FontSize.replace(t.toString(),(t*e).toString())},t.prototype.Clone=function(){var e=new t(this.Position.X,this.Position.Y,this.Text,this.Color.Clone());return e.Align=this.Align,e.Baseline=this.Baseline,e.FontSettings.FontFamily=this.FontSettings.FontFamily,e.FontSettings.FontSize=this.FontSettings.FontSize,e.FontSettings.FontStyle=this.FontSettings.FontStyle,e.FontSettings.FontVariant=this.FontSettings.FontVariant,e.FontSettings.FontWeight=this.FontSettings.FontWeight,s.prototype._Clone.call(this,e),e},r.Text2d=t,o.Graphics}(EndGate=EndGate||{}),function(r){function t(e,t,n,i,o){void 0===i&&(i=n.ClipSize.Width),void 0===o&&(o=n.ClipSize.Height),s.call(this,new r.Vector2d(e,t)),this._type="Sprite2d",this.Image=n,this.Size=new r.Size2d(i,o)}var e,s;e=r.Graphics||(r.Graphics={}),s=e.Graphic2d,__extends(t,s),t.prototype.Draw=function(e){s.prototype._StartDraw.call(this,e),e.drawImage(this.Image.Source,this.Image.ClipLocation.X,this.Image.ClipLocation.Y,this.Image.ClipSize.Width,this.Image.ClipSize.Height,-this.Size.HalfWidth,-this.Size.HalfHeight,this.Size.Width,this.Size.Height),s.prototype._EndDraw.call(this,e)},t.prototype.GetDrawBounds=function(){var e=new r.Bounds.BoundingRectangle(this.Position,this.Size);return e.Rotation=this.Rotation,e},t.prototype.Scale=function(e){this.Size.Width*=e,this.Size.Height*=e},t.prototype.Clone=function(){var e=new t(this.Position.X,this.Position.Y,this.Image.Clone(),this.Size.Width,this.Size.Height);return s.prototype._Clone.call(this,e),e},e.Sprite2d=t,r.Graphics}(EndGate=EndGate||{}),function(s){!function(e){function t(t,e,n,i,o){void 0===o&&(o=s.Vector2d.Zero);var r=this;this._imageSource=t,this._frameSize=n,this._frameCount=i,this._startOffset=o,this._playing=!1,this._repeating=!1,this._currentFrame=0,this._lastStepAt=0,this._onComplete=new s.EventHandler,this.Fps=e,null!==t.ClipSize||t.IsLoaded()?(this._framesPerRow=Math.min(Math.floor((t.Size.Width-o.X)/n.Width),i),this.UpdateImageSource()):(t.OnLoaded.BindFor(function(e){r._framesPerRow=Math.min(Math.floor((t.Size.Width-o.X)/n.Width),i),r.UpdateImageSource()},1),this._framesPerRow=1)}Object.defineProperty(t.prototype,"OnComplete",{get:function(){return this._onComplete},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Fps",{get:function(){return this._fps},set:function(e){this._fps=e,this._stepEvery=1e3/this._fps},enumerable:!0,configurable:!0}),t.prototype.IsPlaying=function(){return this._playing},t.prototype.CanPlay=function(){return this._imageSource.IsLoaded()},t.prototype.Play=function(e){if(void 0===e&&(e=!1),!this._imageSource.ClipSize)throw new Error("Image source not loaded yet.");this._lastStepAt=(new Date).getTime(),this._repeating=e,this._playing=!0,this.UpdateImageSource()},t.prototype.Pause=function(){this._playing=!1},t.prototype.Step=function(e){this._currentFrame+=e=void 0===e?1:e,this._currentFrame>=this._frameCount&&(this._repeating?this._currentFrame%=this._frameCount:(this._currentFrame=this._frameCount-1,this.OnComplete.Trigger(),this.Stop(!1))),0!==e&&this.UpdateImageSource()},t.prototype.Stop=function(e){void 0===e&&(e=!0),this._playing=!1,e&&this.Reset()},t.prototype.Reset=function(){this._currentFrame=0,this.UpdateImageSource()},t.prototype.Update=function(e){var t=e.Now.getTime()-this._lastStepAt;this._playing&&0<(t=Math.floor(t/this._stepEvery))&&(this._lastStepAt=e.Now.getTime(),this.Step(t))},t.prototype.Dispose=function(){this._onComplete.Dispose()},t.prototype.UpdateImageSource=function(){var e=this.GetFrameRow(),t=this.GetFrameColumn();this._imageSource.ClipLocation.X=this._startOffset.X+t*this._frameSize.Width,this._imageSource.ClipLocation.Y=this._startOffset.Y+e*this._frameSize.Height,this._imageSource.ClipSize=this._frameSize},t.prototype.GetFrameRow=function(){return Math.floor(this._currentFrame/this._framesPerRow)},t.prototype.GetFrameColumn=function(){return Math.ceil(this._currentFrame%this._framesPerRow)},e.SpriteAnimation=t}(s.Graphics||(s.Graphics={}));s.Graphics}(EndGate=EndGate||{}),function(o){function t(e,t,n,i){r.call(this,new o.Vector2d(e,t),i),this._type="Circle",this.Radius=n}var e,r;e=o.Graphics||(o.Graphics={}),r=e.Shape,__extends(t,r),t.prototype.GetDrawBounds=function(){var e=new o.Bounds.BoundingCircle(this.Position,this.Radius);return e.Rotation=this.Rotation,e},t.prototype.Scale=function(e){this.Radius*=e},t.prototype.Clone=function(){var e=new t(this.Position.X,this.Position.Y,this.Radius,this.Color.Clone());return r.prototype._Clone.call(this,e),e},t.prototype._BuildPath=function(e){e.arc(0,0,this.Radius,0,Math.twoPI)},e.Circle=t,o.Graphics}(EndGate=EndGate||{}),function(r){function t(e,t,n,i,o){s.call(this,new r.Vector2d(e,t),o),this._type="Rectangle",this.Size=new r.Size2d(n,i)}var e,s;e=r.Graphics||(r.Graphics={}),s=e.Shape,__extends(t,s),t.prototype.GetDrawBounds=function(){var e=new r.Bounds.BoundingRectangle(this.Position,this.Size);return e.Rotation=this.Rotation,e},t.prototype.Scale=function(e){this.Size.Width*=e,this.Size.Height*=e},t.prototype.Clone=function(){var e=new t(this.Position.X,this.Position.Y,this.Size.Width,this.Size.Height,this.Color.Clone());return s.prototype._Clone.call(this,e),e},t.prototype._BuildPath=function(e){e.rect(-this.Size.HalfWidth,-this.Size.HalfHeight,this.Size.Width,this.Size.Height)},e.Rectangle=t,r.Graphics}(EndGate=EndGate||{}),function(a){function t(e,t,n,i,o,r){void 0===o&&(o=1);var s=this;l.call(this,a.Vector2d.Zero),this._type="Line2d",this._from=new a.Vector2d(e,t),this._to=new a.Vector2d(n,i),this.LineWidth=o,this.UpdatePosition(),this._strokeChangeWire=function(e){s._State.StrokeStyle=e.toString()},void 0!==r?("string"==typeof r&&(r=new u.Color(r)),this.Color=this._strokeStyle=r):this.Color=this._strokeStyle=u.Color.Black}var u,l;u=a.Graphics||(a.Graphics={}),l=u.Graphic2d,__extends(t,l),Object.defineProperty(t.prototype,"From",{get:function(){return this._from},set:function(e){this._from=e,this.UpdatePosition()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"To",{get:function(){return this._to},set:function(e){this._to=e,this.UpdatePosition()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Color",{get:function(){return this._strokeStyle},set:function(e){"string"==typeof e&&(e=new u.Color(e)),this._strokeStyle.OnChange.Unbind(this._strokeChangeWire),this._strokeStyle=e,this._strokeStyle.OnChange.Bind(this._strokeChangeWire),this._strokeChangeWire(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"LineWidth",{get:function(){return this._State.LineWidth},set:function(e){this._State.LineWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"LineCap",{get:function(){return this._State.LineCap},set:function(e){this._State.LineCap=e},enumerable:!0,configurable:!0}),t.prototype.Draw=function(e){this._strokeStyle.toString()!==this._State.StrokeStyle&&(this._State.StrokeStyle=this._strokeStyle.toString()),l.prototype._StartDraw.call(this,e),this._cachedPosition.Equivalent(this.Position)||this.RefreshCache(),e.beginPath(),e.moveTo(this._from.X-this.Position.X,this._from.Y-this.Position.Y),e.lineTo(this._to.X-this.Position.X,this._to.Y-this.Position.Y),e.stroke(),l.prototype._EndDraw.call(this,e)},t.prototype.GetDrawBounds=function(){var e=new a.Bounds.BoundingRectangle(this.Position,new a.Size2d(this._boundsWidth,this.LineWidth));return e.Rotation=Math.atan2(this._difference.Y,this._difference.X)+this.Rotation,e},t.prototype.Scale=function(e){this.From=this.Position.Add(this.From.Subtract(this.Position).Multiply(e)),this.To=this.Position.Add(this.To.Subtract(this.Position).Multiply(e))},t.prototype.Clone=function(){var e=new t(this.From.X,this.From.Y,this.To.X,this.To.Y,this.LineWidth,this.Color.Clone());return e.LineCap=this.LineCap,l.prototype._Clone.call(this,e),e},t.prototype.Dispose=function(){l.prototype.Dispose.call(this),this._strokeStyle.OnChange.Unbind(this._strokeChangeWire)},t.prototype.UpdatePosition=function(){this.Position=this._from.Add(this._to).Divide(2),this._difference=this._to.Subtract(this._from),this._boundsWidth=this._from.Distance(this._to).Length(),this._cachedPosition=this.Position.Clone()},t.prototype.RefreshCache=function(){var e=this.Position.Subtract(this._cachedPosition);this._from.X+=e.X,this._from.Y+=e.Y,this._to.X+=e.X,this._to.Y+=e.Y,this._cachedPosition=this.Position.Clone()},u.Line2d=t,a.Graphics}(EndGate=EndGate||{}),function(h){function i(e,t,n,i,o,r,s,a){void 0===s&&(s=!1),void 0===a&&(a=new c.Color("gray")),d.call(this,new h.Vector2d(e,t)),this._type="Grid",this._size=new h.Size2d(o*i,r*n),this._tileSize=new h.Size2d(o,r),this._grid=[],this._rows=n,this._columns=i,this._gridLines=[],this.GridLineColor=a,this.DrawGridLines=s;for(var u=0;u<this._rows;u++){this._grid[u]=[];for(var l=0;l<this._columns;l++)this._grid[u].push(null)}}var c,d;c=h.Graphics||(h.Graphics={}),d=c.Graphic2d,__extends(i,d),Object.defineProperty(i.prototype,"DrawGridLines",{get:function(){return this._drawGridLines},set:function(e){e&&0===this._gridLines.length&&this.BuildGridLines(),this._drawGridLines=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"GridLineColor",{get:function(){return this._gridLineColor},set:function(e){"string"==typeof e&&(e=new c.Color(e)),this._gridLineColor=e;for(var t=0;t<this._gridLines.length;t++)this._gridLines[t].Color=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Size",{get:function(){return this._size.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"TileSize",{get:function(){return this._tileSize.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Rows",{get:function(){return this._rows},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Columns",{get:function(){return this._columns},enumerable:!0,configurable:!0}),i.prototype.Fill=function(e,t,n){n&&this.ValidRow(e)&&this.ValidColumn(t)&&(n.Position=this.GetInsideGridPosition(e,t),this._grid[e][t]=n,this.AddChild(n))},i.prototype.FillRow=function(e,t,n){var i;void 0===n&&(n=0);for(var o=0;o<t.length;o++)(i=t[o]).Position=this.GetInsideGridPosition(e,o+n),this._grid[e][o+n]=i,this.AddChild(i)},i.prototype.FillColumn=function(e,t,n){var i;void 0===n&&(n=0);for(var o=0;o<t.length;o++)(i=t[o]).Position=this.GetInsideGridPosition(o+n,e),this._grid[o+n][e]=i,this.AddChild(i)},i.prototype.FillSpace=function(e,t,n){for(var i,o=0;o<n.length;o++)for(var r=0;r<n[o].length;r++)(i=n[o][r])&&(i.Position=this.GetInsideGridPosition(o+e,r+t),this._grid[o+e][r+t]=i,this.AddChild(i))},i.prototype.Get=function(e,t){return this.ValidRow(e)&&this.ValidColumn(t)?this._grid[e][t]:null},i.prototype.GetRow=function(e,t){for(var n=[],i=t=void 0===t?0:t;i<this._columns;i++)n.push(this._grid[e][i]);return n},i.prototype.GetColumn=function(e,t){for(var n=[],i=t=void 0===t?0:t;i<this._rows;i++)n.push(this._grid[i][e]);return n},i.prototype.GetSpace=function(e,t,n,i){for(var o=[],r=e<=n?1:-1,s=t<=i?1:-1,a=e;a!==n+r&&!(a>=this._rows);a+=r)for(var u=t;u!==i+s&&!(u>=this._columns);u+=s)o.push(this._grid[a][u]);return o},i.prototype.Clear=function(e,t){if(!this.ValidRow(e)||!this.ValidColumn(t))return null;var n=this._grid[e][t];return this._grid[e][t]=null,this.RemoveChild(n),n},i.prototype.ClearRow=function(e,t){void 0===t&&(t=0);for(var n=[],i=0;i<this._columns;i++)n.push(this._grid[e][i]),this.RemoveChild(this._grid[e][i]),this._grid[e][i]=null;return n},i.prototype.ClearColumn=function(e,t){void 0===t&&(t=0);for(var n=[],i=0;i<this._rows;i++)n.push(this._grid[i][e]),this.RemoveChild(this._grid[i][e]),this._grid[i][e]=null;return n},i.prototype.ClearSpace=function(e,t,n,i){for(var o=[],r=e<=n?1:-1,s=t<=i?1:-1,a=e;a!==n+r&&!(a>this._rows);a+=r)for(var u=t;u!==i+s&&!(u>this._columns);u+=s)o.push(this._grid[a][u]),this.RemoveChild(this._grid[a][u]),this._grid[a][u]=null;return o},i.prototype.Draw=function(e){if(d.prototype._StartDraw.call(this,e),e.save(),d.prototype._EndDraw.call(this,e),this.DrawGridLines)for(var t=0;t<this._gridLines.length;t++)this._gridLines[t].Draw(e);e.restore()},i.prototype.GetDrawBounds=function(){var e=new h.Bounds.BoundingRectangle(this.Position,this._size);return e.Rotation=this.Rotation,e},i.prototype.Scale=function(e){throw new Error("Scale is not implemented for the Grid class.")},i.prototype.ConvertToRow=function(e){return Math.floor((e-(this.Position.Y-this._size.HalfHeight))/this._tileSize.Height)},i.prototype.ConvertToColumn=function(e){return Math.floor((e-(this.Position.X-this._size.HalfWidth))/this._tileSize.Width)},i.prototype.Clone=function(){for(var e=new i(this.Position.X,this.Position.Y,this._rows,this._columns,this._tileSize.Width,this._tileSize.Height,this._drawGridLines,this._gridLineColor.Clone()),t=0;t<this._grid.length;t++)for(var n=0;n<this._grid[t].length;n++)this._grid[t][n]&&e.Fill(t,n,this._grid[t][n].Clone());return e.Opacity=this.Opacity,e.Rotation=this.Rotation,e.Visible=this.Visible,e.ZIndex=this.ZIndex,e},i.prototype.BuildGridLines=function(){for(var e=this._size.Multiply(.5),t=new h.Vector2d(-e.Width,-e.Height),n=new h.Vector2d(e.Width,e.Height),i=0;i<this._rows;i++)if(this._gridLines.push(new c.Line2d(t.X,t.Y+i*this._tileSize.Height,n.X,t.Y+i*this._tileSize.Height,1,this._gridLineColor)),0===i)for(var o=0;o<this._columns;o++)this._gridLines.push(new c.Line2d(t.X+o*this._tileSize.Width,t.Y,t.X+o*this._tileSize.Width,n.Y,1,this._gridLineColor));this._gridLines.push(new c.Line2d(t.X,n.Y,n.X,n.Y,1)),this._gridLines.push(new c.Line2d(n.X,t.Y,n.X,n.Y,1))},i.prototype.GetInsideGridPosition=function(e,t){return new h.Vector2d(t*this._tileSize.Width-this._size.HalfWidth+this._tileSize.HalfWidth,e*this._tileSize.Height-this._size.HalfHeight+this._tileSize.HalfHeight)},i.prototype.ValidRow=function(e){return 0<=e&&e<this._rows},i.prototype.ValidColumn=function(e){return 0<=e&&e<this._columns},c.Grid=i,h.Graphics}(EndGate=EndGate||{}),function(t){function n(e,t,n,i){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===i&&(i=0),this._type="Matrix2x2",this.Values=[[e,t],[n,i]]}Object.defineProperty(n,"Zero",{get:function(){return new n},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Identity",{get:function(){return new n(1,0,0,1)},enumerable:!0,configurable:!0}),n.prototype.Apply=function(e){this.Values[0][0]=e(this.Values[0][0]),this.Values[0][1]=e(this.Values[0][1]),this.Values[1][0]=e(this.Values[1][0]),this.Values[1][1]=e(this.Values[1][1])},n.prototype.Trigger=function(e){e(this.Values[0][0]),e(this.Values[0][1]),e(this.Values[1][0]),e(this.Values[1][1])},n.prototype.Add=function(e){return"Matrix2x2"===e._type?new n(this.Values[0][0]+e.Values[0][0],this.Values[0][1]+e.Values[0][1],this.Values[1][0]+e.Values[1][0],this.Values[1][1]+e.Values[1][1]):new n(this.Values[0][0]+e,this.Values[0][1]+e,this.Values[1][0]+e,this.Values[1][1]+e)},n.prototype.Multiply=function(e){return"Matrix2x2"===e._type?new n(this.Values[0][0]*e.Values[0][0]+this.Values[0][1]*e.Values[1][0],this.Values[0][0]*e.Values[0][1]+this.Values[0][1]*e.Values[1][1],this.Values[1][0]*e.Values[0][0]+this.Values[1][1]*e.Values[1][0],this.Values[1][0]*e.Values[0][1]+this.Values[1][1]*e.Values[1][1]):new n(this.Values[0][0]*e,this.Values[0][1]*e,this.Values[1][0]*e,this.Values[1][1]*e)},n.prototype.Subtract=function(e){return"Matrix2x2"===e._type?new n(this.Values[0][0]-e.Values[0][0],this.Values[0][1]-e.Values[0][1],this.Values[1][0]-e.Values[1][0],this.Values[1][1]-e.Values[1][1]):new n(this.Values[0][0]-e,this.Values[0][1]-e,this.Values[1][0]-e,this.Values[1][1]-e)},n.prototype.SubtractFrom=function(e){return"Matrix2x2"===e._type?new n(e.Values[0][0]-this.Values[0][0],e.Values[0][1]-this.Values[0][1],e.Values[1][0]-this.Values[1][0],e.Values[1][1]-this.Values[1][1]):new n(e-this.Values[0][0],e-this.Values[0][1],e-this.Values[1][0],e-this.Values[1][1])},n.prototype.Divide=function(e){return"Matrix2x2"===e._type?new n(this.Values[0][0]/e.Values[0][0],this.Values[0][1]/e.Values[0][1],this.Values[1][0]/e.Values[1][0],this.Values[1][1]/e.Values[1][1]):new n(this.Values[0][0]/e,this.Values[0][1]/e,this.Values[1][0]/e,this.Values[1][1]/e)},n.prototype.DivideFrom=function(e){return"Matrix2x2"===e._type?new n(e.Values[0][0]/this.Values[0][0],e.Values[0][1]/this.Values[0][1],e.Values[1][0]/this.Values[1][0],e.Values[1][1]/this.Values[1][1]):new n(e/this.Values[0][0],e/this.Values[0][1],e/this.Values[1][0],e/this.Values[1][1])},n.prototype.Transform=function(e){return new t.Vector2d(this.Values[0][0]*e.X+this.Values[0][1]*e.Y,this.Values[1][0]*e.X+this.Values[1][1]*e.Y)},n.prototype.Transpose=function(){return new n(this.Values[0][0],this.Values[1][0],this.Values[0][1],this.Values[1][1])},n.prototype.Determinant=function(){return this.Values[0][0]*this.Values[1][1]-this.Values[0][1]*this.Values[1][0]},n.prototype.Inverse=function(){return new n(this.Values[1][1],-this.Values[0][1],-this.Values[1][0],this.Values[0][0]).Multiply(1/this.Determinant())},n.prototype.Clone=function(){return new n(this.Values[0][0],this.Values[0][1],this.Values[1][0],this.Values[1][1])},n.prototype.Equivalent=function(e){return this.Values[0][0]===e.Values[0][0]&&this.Values[0][1]===e.Values[0][1]&&this.Values[1][0]===e.Values[1][0]&&this.Values[1][1]===e.Values[1][1]},n.prototype.toString=function(){return this.Values[0].toString()+" "+this.Values[1].toString()},n.Scale=function(e){return new n(e.X,0,0,e.Y)},t.Matrix2x2=n}(EndGate=EndGate||{}),function(i){function e(e,t,n){o.call(this,new i.Vector2d(e,t)),this._Resources=n}var t,o;t=i.Graphics||(i.Graphics={}),o=i.Graphics.Graphic2d,__extends(e,o),e.prototype.Scale=function(e){throw new Error("Scale is not implemented for TileMaps.")},t.TileMap=e,i.Graphics}(EndGate=EndGate||{}),function(o){!function(e){function t(e,t,n){i.call(this,0,0,e,t,n)}var n,i;n=e.Assets||(e.Assets={}),i=o.Graphics.Sprite2d,__extends(t,i),n.SquareTile=t,e.Assets}(o.Graphics||(o.Graphics={}));o.Graphics}(EndGate=EndGate||{}),function(l){function t(e,t,n,i,o,r,s,a){void 0===s&&(s=!0),void 0===a&&(a=!1);var u=this;h.call(this,e,t,o),this._mappings=r,this._grid=new l.Graphics.Grid(0,0,r.length,r[0].length,n,i,a),this._staticMap=s,this._onTileLoad=new l.EventHandler2,this._onLoaded=new l.EventHandler,this._loaded=!1,this._tilesBuilt=0,this._totalTiles=this._grid.Rows*this._grid.Columns,this.TileLoadDelay=l.TimeSpan.Zero,this.RowLoadDelay=l.TimeSpan.Zero,this._staticMap&&this.BuildCache(),setTimeout(function(){u.FillGridWith(r,function(){u._loaded=!0,u._onLoaded.Trigger()})},0)}var s,h;s=l.Graphics||(l.Graphics={}),h=s.TileMap,__extends(t,h),Object.defineProperty(t.prototype,"OnTileLoad",{get:function(){return this._onTileLoad},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"OnLoaded",{get:function(){return this._onLoaded},enumerable:!0,configurable:!0}),t.ExtractTiles=function(e,t,n){for(var i=[],o=Math.floor(e.ClipSize.Width/t),r=Math.floor(e.ClipSize.Height/n),s=0;s<r;s++)for(var a=0;a<o;a++)i.push(e.Extract(a*t,s*n,t,n));return i},t.prototype.IsLoaded=function(){return this._loaded},t.prototype.Draw=function(e){h.prototype._StartDraw.call(this,e),this._staticMap?e.drawImage(this._mapCache,-this._mapCache.width/2,-this._mapCache.height/2):this._grid.Draw(e),h.prototype._EndDraw.call(this,e)},t.prototype.GetDrawBounds=function(){var e=this._grid.GetDrawBounds();return e.Position=this.Position,e},t.prototype.Dispose=function(){this._grid.Dispose(),this._onLoaded.Dispose(),this._onTileLoad.Dispose(),h.prototype.Dispose.call(this)},t.prototype.Clone=function(){var e=new t(this.Position.X,this.Position.Y,this._grid.TileSize.Width,this._grid.TileSize.Height,this._Resources,this._mappings);return e.Opacity=this.Opacity,e.Rotation=this.Rotation,e.Visible=this.Visible,e.ZIndex=this.ZIndex,e.RowLoadDelay=this.RowLoadDelay.Clone(),e.TileLoadDelay=this.TileLoadDelay.Clone(),e},t.prototype.BuildCache=function(){var e=this._grid.Size;this._grid.Position;this._mapCache=document.createElement("canvas"),this._mapCache.width=e.Width,this._mapCache.height=e.Height,this._mapCacheContext=this._mapCache.getContext("2d"),this._mapCacheContext.translate(e.HalfWidth,e.HalfHeight)},t.prototype.CacheTile=function(e){e.Draw(this._mapCacheContext)},t.prototype.FillGridWith=function(n,e){var i=this;asyncLoop(function(e,t){i.AsyncBuildGridRow(t,n,function(){e()})},n.length,function(){e()})},t.prototype.AsyncBuildGridTile=function(t,n,i,o){function e(){var e=r._Resources[i],e=new s.Assets.SquareTile(e,r._grid.TileSize.Width,r._grid.TileSize.Height);r._grid.Fill(t,n,e),r.OnTileLoad.Trigger({Tile:e,Row:t,Column:n,ResourceIndex:i,Parent:r},r._tilesBuilt/r._totalTiles),r._staticMap&&r.CacheTile(e),o(e)}var r=this;0<this.TileLoadDelay.Milliseconds?setTimeout(e,this.TileLoadDelay.Milliseconds):e()},t.prototype.AsyncBuildGridRow=function(n,i,e){var o=this;setTimeout(function(){asyncLoop(function(t,e){o._tilesBuilt++,0<=i[n][e]?o.AsyncBuildGridTile(n,e,i[n][e],function(e){t()}):t()},i[n].length,function(){e()})},this.RowLoadDelay.Milliseconds)},s.SquareTileMap=t,l.Graphics}(EndGate=EndGate||{}),function(e){var t,n;t=e.MapLoaders||(e.MapLoaders={}),(n=t.JSONFormat||(t.JSONFormat={}))[n.TMX=0]="TMX",t.JSONFormat,e.MapLoaders}(EndGate=EndGate||{}),function(d){var e,t;e=d.MapLoaders||(d.MapLoaders={}),function(e){function h(){}h.prototype.Load=function(r,s,t){var a=this,u=0,e=0,l=new d.EventHandler1;this.LoadTilesetSources(r.tilesets,function(e){u+=1/r.tilesets.length*h._imagePercentMax,l.Trigger(u)},function(e){var n=a.ExtractTilesetTiles(r.tilesets,e,s),i=new Array,o=(1-h._imagePercentMax)/r.layers.length;u=h._imagePercentMax,asyncLoop(function(t,e){if("tilelayer"!==r.layers[e].type)throw new Error("Invalid layer type.  The layer type '"+r.layers[e].type+"' is not supported.");a.AsyncBuildLayer(r,e,s,n,function(e,t){l.Trigger(u+t*o)},function(e){u+=o,l.Trigger(u),i.push(e),t()})},r.layers.length,function(){t({Layers:i})})});for(var n=0;n<r.layers.length;n++)e+=r.layers[n].data.length;return{TileCount:e,LayerCount:r.layers.length,ResourceSheetCount:r.tilesets.length,OnPercentLoaded:l}},h.prototype.LoadTilesetSources=function(t,n,i){function e(e){n(e),++r===t.length&&i(o)}for(var o={},r=0,s=0;s<t.length;s++)o[t[s].name]=new d.Graphics.ImageSource(t[s].image,t[s].imagewidth,t[s].imageheight),o[t[s].name].OnLoaded.Bind(e)},h.prototype.ExtractTilesetTiles=function(e,t,n){var i,o,r=new Array,s=new Array;e.sort(function(e,t){return e.firstgid-t.firstgid});for(var a=0;a<e.length;a++){for(var u in i=d.Graphics.SquareTileMap.ExtractTiles(t[e[a].name],e[a].tilewidth,e[a].tileheight),e[a].properties)if(void 0!==n.ResourceSheetHooks[u])for(var l=e[a].firstgid-1;l<e[a].firstgid-1+i.length;l++)void 0===s[l]&&(s[l]=new Array),s[l].push(this.BuildHookerFunction(e[a].properties[u],n.ResourceSheetHooks[u]));for(var h in e[a].tileproperties)for(var u in e[a].tileproperties[h])void 0!==n.ResourceTileHooks[u]&&(void 0===s[o=parseInt(h)+e[a].firstgid-1]&&(s[o]=new Array),s[o].push(this.BuildHookerFunction(e[a].tileproperties[h][u],n.ResourceTileHooks[u])));r=r.concat(i)}return{Resources:r,ResourceHooks:s}},h.prototype.AsyncBuildLayer=function(r,s,a,u,l,h){var c=this;setTimeout(function(){var e,t=r.layers[s],n=c.NormalizeLayerData(t.data,r.width),i=new d.Graphics.SquareTileMap(t.x,t.y,r.tilewidth,r.tileheight,u.Resources,n),o=new Array;for(e in t.properties)void 0!==a.LayerHooks[e]&&o.push(c.BuildHookerFunction(t.properties[e],a.LayerHooks[e]));i.ZIndex=s,i.Visible=t.visible,i.Opacity=t.opacity,i.RowLoadDelay=d.TimeSpan.FromMilliseconds(5),i.OnTileLoad.Bind(function(e,t){if(u.ResourceHooks[e.ResourceIndex])for(var n=0;n<u.ResourceHooks[e.ResourceIndex].length;n++)u.ResourceHooks[e.ResourceIndex][n](e);for(n=0;n<o.length;n++)o[n](e);l(e,t)}),i.OnLoaded.Bind(function(){h(i)})},0)},h.prototype.BuildHookerFunction=function(t,n){return function(e){return n(e,t)}},h.prototype.NormalizeLayerData=function(e,t){for(var n,i=new Array,o=0;o<e.length;o++)i[n=Math.floor(o/t)]instanceof Array||(i[n]=new Array),i[n].push(e[o]-1);return i},h._imagePercentMax=.2,e.OrthogonalLoader=h}((t=e._||(e._={})).TMX||(t.TMX={})),t.TMX,e._,d.MapLoaders}(EndGate=EndGate||{}),function(e){var t,n;t=e.MapLoaders||(e.MapLoaders={}),function(e){function t(){this._orientationLoaders={orthogonal:new e.OrthogonalLoader}}t.prototype.Load=function(e,t,n){if(this._orientationLoaders[e.orientation])return this._orientationLoaders[e.orientation].Load(e,t,n);throw new Error("Invalid orientation.  The orientation '"+e.orientation+"' is not supported.")},e.TMXLoader=t}((n=t._||(t._={})).TMX||(n.TMX={})),n.TMX,t._,e.MapLoaders}(EndGate=EndGate||{}),function(e){function o(){}var r;r=e.MapLoaders||(e.MapLoaders={}),o.Load=function(e,t,n,i){return void 0===i&&(i=r.JSONFormat.TMX),o._loaders[r.JSONFormat[i]].Load(e,n=n||{ResourceTileHooks:{},ResourceSheetHooks:{},LayerHooks:{}},t)},o._loaders={TMX:new r._.TMX.TMXLoader},r.JSONLoader=o,e.MapLoaders}(EndGate=EndGate||{}),function(n){!function(e){function t(e,t){void 0===t&&(t=e),this.Min=e,this.Max=t}t.prototype.Clone=function(){return new t(this.Min,this.Max)},t.RandomNumber=function(e){return Math.random()*(e.Max-e.Min)+e.Min},t.RandomTimeSpan=function(e){return n.TimeSpan.FromMilliseconds(Math.floor(Math.random()*(e.Max.Milliseconds-e.Min.Milliseconds+1)+e.Min.Milliseconds))},e.Range=t}(n.Particles||(n.Particles={}));n.Particles}(EndGate=EndGate||{}),function(e){var t=e.Tweening||(e.Tweening={});(function(e){function t(){}Object.defineProperty(t,"EaseNone",{get:function(){return t._easeNone},enumerable:!0,configurable:!0}),t._easeNone=function(e,t,n,i){return(t-e)*n.Milliseconds/i.Milliseconds+e},e.Linear=t})(t.Functions||(t.Functions={})),t.Functions,e.Tweening}(EndGate=EndGate||{}),function(o){!function(e){function t(e,t,n,i){this._from=e.Clone(),this._to=t.Clone(),this._current=this._from.Clone(),this._duration=n,this._elapsed=o.TimeSpan.Zero,this._playing=!1,this._onChange=new o.EventHandler1,this._onComplete=new o.EventHandler1,this._tweeningFunction=i}Object.defineProperty(t.prototype,"OnChange",{get:function(){return this._onChange},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"OnComplete",{get:function(){return this._onComplete},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"From",{get:function(){return this._from},set:function(e){this._from=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"To",{get:function(){return this._to},set:function(e){this._to=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Current",{get:function(){return this._current},set:function(e){this._current=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Duration",{get:function(){return this._duration},set:function(e){this._duration=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Elapsed",{get:function(){return this._elapsed.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TweeningFunction",{get:function(){return this._tweeningFunction},set:function(e){this._tweeningFunction=e},enumerable:!0,configurable:!0}),t.prototype.IsPlaying=function(){return this._playing},t.prototype.Play=function(){this._playing=!0},t.prototype.Pause=function(){this._playing=!1},t.prototype.Reset=function(){this._elapsed.Milliseconds=0,this._current=this._from.Clone()},t.prototype.Stop=function(){this._playing=!1,this.Reset()},t.prototype.Restart=function(){this.Reset(),this.Play()},t.prototype.Reverse=function(){this._elapsed=o.TimeSpan.Zero,this._to=this._from,this._from=this.Current.Clone()},t.prototype.Update=function(e){this._playing&&(this._elapsed=this._elapsed.Add(e.Elapsed),this._elapsed.Milliseconds>=this._duration.Milliseconds?(this._elapsed=this._duration.Clone(),this._current=this._to.Clone(),this._playing=!1,this._onChange.Trigger(this._current.Clone()),this._onComplete.Trigger(this)):(this._UpdateTween(),this._onChange.Trigger(this._current.Clone())))},t.prototype.Dispose=function(){this.Stop(),this._onChange.Dispose(),this._onComplete.Dispose()},t.prototype._UpdateTween=function(){},e.Tween=t}(o.Tweening||(o.Tweening={}));o.Tweening}(EndGate=EndGate||{}),function(e){function t(e,t,n,i){o.call(this,e,t,n,i)}var n,o;n=e.Tweening||(e.Tweening={}),o=n.Tween,__extends(t,o),t.prototype._UpdateTween=function(){this.Current=new e.Vector2d(this.TweeningFunction(this.From.X,this.To.X,this.Elapsed,this.Duration),this.TweeningFunction(this.From.Y,this.To.Y,this.Elapsed,this.Duration))},n.Vector2dTween=t,e.Tweening}(EndGate=EndGate||{}),function(e){function t(e,t,n,i){o.call(this,e,t,n,i)}var n,o;n=e.Tweening||(e.Tweening={}),o=n.Tween,__extends(t,o),t.prototype._UpdateTween=function(){this.Current=this.TweeningFunction(this.From,this.To,this.Elapsed,this.Duration)},n.NumberTween=t,e.Tweening}(EndGate=EndGate||{}),function(c){!function(e){function t(e,t,n,i,o,r,s,a,u,l,h){e.Position=t,e.Scale(i),e.Rotation=r,e.Opacity=0,this._texture=e,this._rotationSpeed=s,this._alive=!0,this._fadingOut=!1,this._lifetime=a,this._createdAt=(new Date).getTime(),this._onDeath=new c.EventHandler1,this._fadeOutDuration=l,this._fadeOutAt=a.Milliseconds-l.Milliseconds,this._locationTween=new c.Tweening.Vector2dTween(e.Position,n,a,h),this._fadeTween=new c.Tweening.NumberTween(0,100*o,u,c.Tweening.Functions.Linear.EaseNone),this._locationTween.Play(),this._fadeTween.Play()}Object.defineProperty(t.prototype,"Texture",{get:function(){return this._texture},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"OnDeath",{get:function(){return this._onDeath},enumerable:!0,configurable:!0}),t.prototype.IsAlive=function(){return this._alive},t.prototype.Update=function(e){var t;this._alive&&((t=e.Now.getTime()-this._createdAt)>this._lifetime.Milliseconds?(this._alive=!1,this._onDeath.Trigger(this)):(!this._fadingOut&&t>=this._fadeOutAt&&(this._fadingOut=!0,this._fadeTween.From=100*this._texture.Opacity,this._fadeTween.To=0,this._fadeTween.Duration=this._fadeOutDuration,this._fadeTween.Restart()),this._locationTween.Update(e),this._fadeTween.Update(e),this._texture.Rotation+=e.Elapsed.Seconds*this._rotationSpeed,this._texture.Position=this._locationTween.Current,this._texture.Opacity=this._fadeTween.Current/100))},e.Particle=t}(c.Particles||(c.Particles={}));c.Particles}(EndGate=EndGate||{}),function(s){function n(e,t,n){var i=this;o.call(this,new s.Vector2d(e,t)),this.EmissionInterval=new a.Range(s.TimeSpan.FromMilliseconds(30)),this.EmissionDirection=new a.Range(0,2*Math.PI),this.EmissionOutput=new a.Range(1),this.ParticleLifetime=new a.Range(s.TimeSpan.FromSeconds(1),s.TimeSpan.FromSeconds(3)),this.ParticleSpeed=new a.Range(30,100),this.ParticleScale=new a.Range(.75,1.5),this.ParticleRotation=new a.Range(0,2*Math.PI),this.ParticleRotationSpeed=new a.Range(0,Math.PI),this.ParticleOpacity=new a.Range(1),this.ParticleFadeInDuration=new a.Range(s.TimeSpan.FromSeconds(.5)),this.ParticleFadeOutDuration=new a.Range(s.TimeSpan.FromSeconds(.5),s.TimeSpan.FromSeconds(1)),this._texturePool=new Array,this._particlePool={},this._particleId=0,this._emitting=!1,this._particleRemover=function(e){i.RemoveChild(e.Texture),delete i._particlePool[e._id]},this.EmissionFunction=n}var a,o;a=s.Particles||(s.Particles={}),o=s.Graphics.Graphic2d,__extends(n,o),n.prototype.IsEmitting=function(){return this._emitting},n.prototype.Start=function(){if(0===this._texturePool.length)throw new Error("Cannot start Emitter without any textures added to it.");this._emitting=!0,this._lastEmit=(new Date).getTime()},n.prototype.Stop=function(){this._emitting=!1},n.prototype.AddTexture=function(e,t){void 0===t&&(t=1);for(var n=0;n<t;n++)this._texturePool.push(e)},n.prototype.RemoveTexture=function(e){for(var t=0;t<this._texturePool.length;t++)this._texturePool[t]===e&&this._texturePool.splice(t--,1)},n.prototype.Emit=function(){for(var e,t,n,i=a.Range.RandomNumber(this.EmissionOutput),o=new Array,r=0;r<i;r++)t=a.Range.RandomTimeSpan(this.ParticleLifetime),e=a.Range.RandomNumber(this.ParticleSpeed),n=a.Range.RandomNumber(this.EmissionDirection),e=new s.Vector2d(t.Seconds*e,0).RotateAround(s.Vector2d.Zero,n),(n=new a.Particle(this.BuildTextureFromPool(),s.Vector2d.Zero,e,a.Range.RandomNumber(this.ParticleScale),a.Range.RandomNumber(this.ParticleOpacity),a.Range.RandomNumber(this.ParticleRotation),a.Range.RandomNumber(this.ParticleRotationSpeed),t,a.Range.RandomTimeSpan(this.ParticleFadeInDuration),a.Range.RandomTimeSpan(this.ParticleFadeOutDuration),this.EmissionFunction))._id=this._particleId++,this._particlePool[n._id]=n,this.AddChild(n.Texture),n.OnDeath.Bind(this._particleRemover),o.push(n);return o},n.prototype.Draw=function(e){o.prototype._StartDraw.call(this,e),o.prototype._EndDraw.call(this,e)},n.prototype.Scale=function(e){throw new Error("Scale is not implemented for the Emitter class.")},n.prototype.Update=function(e){var t,n,i;if(this._emitting){if(0<(i=a.Range.RandomTimeSpan(this.EmissionInterval).Milliseconds)&&(t=e.Now.getTime()-this._lastEmit,0<(n=Math.floor(t/i)))){this._lastEmit=e.Now.getTime();for(var o=0;o<n;o++)this.Emit()}for(var r in this._particlePool)this._particlePool[r].Update(e)}},n.prototype.GetDrawBounds=function(){return new s.Bounds.BoundingCircle(this.Position,this.ParticleSpeed.Max*this.ParticleLifetime.Max.Seconds)},n.prototype.Clone=function(){for(var e=new n(this.Position.X,this.Position.Y,this.EmissionFunction),t=0;t<this._texturePool.length;t++)e.AddTexture(this._texturePool[t]);return e.EmissionInterval=this.EmissionInterval.Clone(),e.EmissionDirection=this.EmissionDirection.Clone(),e.EmissionOutput=this.EmissionOutput.Clone(),e.ParticleLifetime=this.ParticleLifetime.Clone(),e.ParticleSpeed=this.ParticleSpeed.Clone(),e.ParticleRotation=this.ParticleRotation.Clone(),e.ParticleRotationSpeed=this.ParticleRotationSpeed.Clone(),e.ParticleFadeInDuration=this.ParticleFadeInDuration.Clone(),e.ParticleFadeOutDuration=this.ParticleFadeOutDuration.Clone(),e.ParticleScale=this.ParticleScale.Clone(),e.ParticleOpacity=this.ParticleOpacity.Clone(),e.Opacity=this.Opacity,e.Rotation=this.Rotation,e.Visible=this.Visible,e.ZIndex=this.ZIndex,e},n.prototype.BuildTextureFromPool=function(){var e=Math.floor(Math.random()*this._texturePool.length);return this._texturePool[e].Clone()},a.Emitter=n,s.Particles}(EndGate=EndGate||{}),function(e){function t(e,t,n,i){o.call(this,e,t,n,i)}var n,o;n=e.Tweening||(e.Tweening={}),o=n.Tween,__extends(t,o),t.prototype._UpdateTween=function(){this.Current.R=this.TweeningFunction(this.From.R,this.To.R,this.Elapsed,this.Duration),this.Current.G=this.TweeningFunction(this.From.G,this.To.G,this.Elapsed,this.Duration),this.Current.B=this.TweeningFunction(this.From.B,this.To.B,this.Elapsed,this.Duration)},n.ColorTween=t,e.Tweening}(EndGate=EndGate||{}),function(e){function t(e,t,n,i){o.call(this,e,t,n,i)}var n,o;n=e.Tweening||(e.Tweening={}),o=n.Tween,__extends(t,o),t.prototype._UpdateTween=function(){this.Current=new e.Size2d(this.TweeningFunction(this.From.Width,this.To.Width,this.Elapsed,this.Duration),this.TweeningFunction(this.From.Height,this.To.Height,this.Elapsed,this.Duration))},n.Size2dTween=t,e.Tweening}(EndGate=EndGate||{}),function(e){var t=e.Tweening||(e.Tweening={});(function(e){function t(){}Object.defineProperty(t,"EaseIn",{get:function(){return t._easeIn},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EaseOut",{get:function(){return t._easeOut},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EaseInOut",{get:function(){return t._easeInOut},enumerable:!0,configurable:!0}),t._easeIn=function(e,t,n,i){n=n.Milliseconds;return(t-e)*(n/=i.Milliseconds)*n*(2.70158*n-1.70158)+e},t._easeOut=function(e,t,n,i){return(t-e)*((t=n.Milliseconds/i.Milliseconds-1)*t*(2.70158*t+1.70158)+1)+e},t._easeInOut=function(e,t,n,i){var t=t-e,n=n.Milliseconds,o=1.70158;return(n/=i.Milliseconds/2)<1?t/2*(n*n*((1+(o*=1.525))*n-o))+e:t/2*((n-=2)*n*((1+(o*=1.525))*n+o)+2)+e},e.Back=t})(t.Functions||(t.Functions={})),t.Functions,e.Tweening}(EndGate=EndGate||{}),function(e){var t=e.Tweening||(e.Tweening={});(function(e){function o(){}Object.defineProperty(o,"EaseIn",{get:function(){return o._easeIn},enumerable:!0,configurable:!0}),Object.defineProperty(o,"EaseOut",{get:function(){return o._easeOut},enumerable:!0,configurable:!0}),Object.defineProperty(o,"EaseInOut",{get:function(){return o._easeInOut},enumerable:!0,configurable:!0}),o._easeIn=function(e,t,n,i){t-=e;return t-o.EaseOut(0,t,i.Subtract(n),i)+e},o._easeOut=function(e,t,n,i){t-=e,n=n.Milliseconds;return(n/=i.Milliseconds)<1/2.75?7.5625*n*n*t+e:n<2/2.75?t*(7.5625*(n-=1.5/2.75)*n+.75)+e:n<2.5/2.75?t*(7.5625*(n-=2.25/2.75)*n+.9375)+e:t*(7.5625*(n-=2.625/2.75)*n+.984375)+e},o._easeInOut=function(e,t,n,i){t-=e;return n.Milliseconds<i.Milliseconds/2?.5*o.EaseIn(0,t,n.Multiply(2),i)+e:.5*o.EaseOut(0,t,n.Multiply(2).Subtract(i),i)+.5*t+e},e.Bounce=o})(t.Functions||(t.Functions={})),t.Functions,e.Tweening}(EndGate=EndGate||{}),function(e){var t=e.Tweening||(e.Tweening={});(function(e){function t(){}Object.defineProperty(t,"EaseIn",{get:function(){return t._easeIn},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EaseOut",{get:function(){return t._easeOut},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EaseInOut",{get:function(){return t._easeInOut},enumerable:!0,configurable:!0}),t._easeIn=function(e,t,n,i){n=n.Milliseconds;return-(t-e)*(Math.sqrt(1-(n/=i.Milliseconds)*n)-1)+e},t._easeOut=function(e,t,n,i){n=n.Milliseconds;return(t-e)*Math.sqrt(1-(n=n/i.Milliseconds-1)*n)+e},t._easeInOut=function(e,t,n,i){t-=e,n=n.Milliseconds;return(n/=i.Milliseconds/2)<1?-t/2*(Math.sqrt(1-n*n)-1)+e:t/2*(Math.sqrt(1-(n-=2)*n)+1)+e},e.Circular=t})(t.Functions||(t.Functions={})),t.Functions,e.Tweening}(EndGate=EndGate||{}),function(e){var t=e.Tweening||(e.Tweening={});(function(e){function t(){}Object.defineProperty(t,"EaseIn",{get:function(){return t._easeIn},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EaseOut",{get:function(){return t._easeOut},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EaseInOut",{get:function(){return t._easeInOut},enumerable:!0,configurable:!0}),t._easeIn=function(e,t,n,i){n=n.Milliseconds;return(t-e)*(n/=i.Milliseconds)*n*n+e},t._easeOut=function(e,t,n,i){return(t-e)*((t=n.Milliseconds/i.Milliseconds-1)*t*t+1)+e},t._easeInOut=function(e,t,n,i){t-=e,n=n.Milliseconds;return(n/=i.Milliseconds/2)<1?t/2*n*n*n+e:t/2*((n-=2)*n*n+2)+e},e.Cubic=t})(t.Functions||(t.Functions={})),t.Functions,e.Tweening}(EndGate=EndGate||{}),function(e){var t=e.Tweening||(e.Tweening={});(function(e){function t(){}Object.defineProperty(t,"EaseIn",{get:function(){return t._easeIn},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EaseOut",{get:function(){return t._easeOut},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EaseInOut",{get:function(){return t._easeInOut},enumerable:!0,configurable:!0}),t._easeIn=function(e,t,n,i){var o,r,t=t-e,n=n.Milliseconds;return 0===n?e:1==(n/=i.Milliseconds)?e+t:(r=(o=.3*i.Milliseconds)/4,-(t*Math.pow(2,10*--n)*Math.sin((n*i.Milliseconds-r)*(2*Math.PI)/o))+e)},t._easeOut=function(e,t,n,i){var o,r,t=t-e,n=n.Milliseconds;return 0===n?e:1==(n/=i.Milliseconds)?e+t:(r=(o=.3*i.Milliseconds)/4,t*Math.pow(2,-10*n)*Math.sin((n*i.Milliseconds-r)*(2*Math.PI)/o)+t+e)},t._easeInOut=function(e,t,n,i){var o,r,t=t-e,n=n.Milliseconds;return 0===n?e:2==(n/=i.Milliseconds/2)?e+t:(r=(o=i.Milliseconds*(.3*1.5))/4,n<1?t*Math.pow(2,10*--n)*Math.sin((n*i.Milliseconds-r)*(2*Math.PI)/o)*-.5+e:t*Math.pow(2,-10*--n)*Math.sin((n*i.Milliseconds-r)*(2*Math.PI)/o)*.5+t+e)},e.Elastic=t})(t.Functions||(t.Functions={})),t.Functions,e.Tweening}(EndGate=EndGate||{}),function(e){var t=e.Tweening||(e.Tweening={});(function(e){function t(){}Object.defineProperty(t,"EaseIn",{get:function(){return t._easeIn},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EaseOut",{get:function(){return t._easeOut},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EaseInOut",{get:function(){return t._easeInOut},enumerable:!0,configurable:!0}),t._easeIn=function(e,t,n,i){n=n.Milliseconds;return 0==n?e:(t-e)*Math.pow(2,10*(n/i.Milliseconds-1))+e},t._easeOut=function(e,t,n,i){t-=e,n=n.Milliseconds;return n==i.Milliseconds?e+t:t*(1-Math.pow(2,-10*n/i.Milliseconds))+e},t._easeInOut=function(e,t,n,i){t-=e,n=n.Milliseconds;return 0==n?e:n==i.Milliseconds?e+t:(n/=i.Milliseconds/2)<1?t/2*Math.pow(2,10*(n-1))+e:t/2*(2-Math.pow(2,-10*--n))+e},e.Exponential=t})(t.Functions||(t.Functions={})),t.Functions,e.Tweening}(EndGate=EndGate||{}),function(e){var t=e.Tweening||(e.Tweening={});(function(e){function t(){}Object.defineProperty(t,"EaseIn",{get:function(){return t._easeIn},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EaseOut",{get:function(){return t._easeOut},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EaseInOut",{get:function(){return t._easeInOut},enumerable:!0,configurable:!0}),t._easeIn=function(e,t,n,i){n=n.Milliseconds;return(t-e)*(n/=i.Milliseconds)*n+e},t._easeOut=function(e,t,n,i){n=n.Milliseconds;return-(t-e)*(n/=i.Milliseconds)*(n-2)+e},t._easeInOut=function(e,t,n,i){t-=e,n=n.Milliseconds;return(n/=i.Milliseconds/2)<1?t/2*n*n+e:-t/2*(--n*(n-2)-1)+e},e.Quadratic=t})(t.Functions||(t.Functions={})),t.Functions,e.Tweening}(EndGate=EndGate||{}),function(e){var t=e.Tweening||(e.Tweening={});(function(e){function t(){}Object.defineProperty(t,"EaseIn",{get:function(){return t._easeIn},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EaseOut",{get:function(){return t._easeOut},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EaseInOut",{get:function(){return t._easeInOut},enumerable:!0,configurable:!0}),t._easeIn=function(e,t,n,i){n=n.Milliseconds;return(t-e)*(n/=i.Milliseconds)*n*n*n+e},t._easeOut=function(e,t,n,i){return-(t-e)*((t=n.Milliseconds/i.Milliseconds-1)*t*t*t-1)+e},t._easeInOut=function(e,t,n,i){t-=e,n=n.Milliseconds;return(n/=i.Milliseconds/2)<1?t/2*n*n*n*n+e:-t/2*((n-=2)*n*n*n-2)+e},e.Quartic=t})(t.Functions||(t.Functions={})),t.Functions,e.Tweening}(EndGate=EndGate||{}),function(e){var t=e.Tweening||(e.Tweening={});(function(e){function t(){}Object.defineProperty(t,"EaseIn",{get:function(){return t._easeIn},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EaseOut",{get:function(){return t._easeOut},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EaseInOut",{get:function(){return t._easeInOut},enumerable:!0,configurable:!0}),t._easeIn=function(e,t,n,i){n=n.Milliseconds;return(t-e)*(n/=i.Milliseconds)*n*n*n*n+e},t._easeOut=function(e,t,n,i){return(t-e)*((t=n.Milliseconds/i.Milliseconds-1)*t*t*t*t+1)+e},t._easeInOut=function(e,t,n,i){t-=e,n=n.Milliseconds;return(n/=i.Milliseconds/2)<1?t/2*n*n*n*n*n+e:t/2*((n-=2)*n*n*n*n+2)+e},e.Quintic=t})(t.Functions||(t.Functions={})),t.Functions,e.Tweening}(EndGate=EndGate||{}),function(e){var t=e.Tweening||(e.Tweening={});(function(e){function t(){}Object.defineProperty(t,"EaseIn",{get:function(){return t._easeIn},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EaseOut",{get:function(){return t._easeOut},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EaseInOut",{get:function(){return t._easeInOut},enumerable:!0,configurable:!0}),t._easeIn=function(e,t,n,i){t-=e,n=n.Milliseconds;return-t*Math.cos(n/i.Milliseconds*(Math.PI/2))+t+e},t._easeOut=function(e,t,n,i){n=n.Milliseconds;return(t-e)*Math.sin(n/i.Milliseconds*(Math.PI/2))+e},t._easeInOut=function(e,t,n,i){n=n.Milliseconds;return-(t-e)/2*(Math.cos(Math.PI*n/i.Milliseconds)-1)+e},e.Sinusoidal=t})(t.Functions||(t.Functions={})),t.Functions,e.Tweening}(EndGate=EndGate||{}),function(e){function t(){this._type="EventHandler3",this._actions=[]}t.prototype.Bind=function(e){this._actions.push(e)},t.prototype.BindFor=function(e,t){function n(){++o>=t&&i.Unbind(n),e.apply(this,arguments)}var i=this,o=0;this._actions.push(n)},t.prototype.Unbind=function(e){for(var t=0;t<this._actions.length;t++)if(this._actions[t]===e)return void this._actions.splice(t,1)},t.prototype.HasBindings=function(){return 0<this._actions.length},t.prototype.Trigger=function(e,t,n){if(this.HasBindings())for(var i=this._actions.slice(0),o=0;o<i.length;o++)i[o](e,t,n)},t.prototype.Dispose=function(){this._actions=[]},e.EventHandler3=t}(EndGate=EndGate||{}),function(r){function t(e){var t=this;this._tryCount=0,this._requestedAt=null,this._pingData=new Array,this.Latency="...",e.OnPingRequest.Bind(function(){t._requestedAt&&(t.AddData((new Date).getTime()-t._requestedAt.getTime()),t._requestedAt=null)})}t.prototype.TryRequestPing=function(){return++this._tryCount%t.REQUEST_PING_EVERY==0&&(this._requestedAt=new Date,!0)},t.prototype.AddData=function(e){this._pingData.length===t.PING_DATA_POINTS&&this._pingData.shift(),this._pingData.push(e),this.UpdateLatency()},t.prototype.UpdateLatency=function(){for(var e=0,t=0,n=r.StandardDeviation(this._pingData),i=r.Average(this._pingData),o=0;o<this._pingData.length;o++)Math.abs(this._pingData[o]-i)<=n&&(e++,t+=this._pingData[o]);0<e&&(this.Latency=Math.round(t/e).toString()+"ms")},t.REQUEST_PING_EVERY=5,t.PING_DATA_POINTS=100,r.LatencyResolver=t}(Wanted=Wanted||{});var Wanted,__extends=this.__extends||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i},eg=EndGate,eg=(!function(r){s=eg.Game,__extends(a,s),a.prototype.LoadContent=function(){},a.prototype.Update=function(e){this._cursorManager.Update(e),this._hud.Update(e)},a.prototype.Draw=function(e){};var s,e=a;function a(e,t,n,i){var o=this;return s.call(this,e),a.GameConfiguration=new r.ConfigurationManager(i.Configuration),this._cursorManager=new r.CursorManager(this._bufferedViewport,this.Scene,this.CollisionManager,this.Content),this._cursorManager.Initialize(new r.UserCursorManager(i.CursorId,this._cursorManager,this.Input,n)),this._hud=new r.HUDManager(i,this._cursorManager,this._map.AreaRenderer,this.Input.Keyboard,n),n.OnPayload.Bind(function(e){o._cursorManager.LoadPayload(e),o._hud.LoadPayload(e)}),null!==s&&s.apply(this,arguments)||this}r.Game=e}(Wanted=Wanted||{}),!function(o){function e(e,t,n){var i=this;this._gameCanvas=e,this._popUpHolder=t,this._serverAdapter=n,this._gameHUDHeight=$("#gameHUD").height(),this.Viewport=this.UpdateViewport(),this.OnResize=new EndGate.EventHandler1,this.OnResizeComplete=new EndGate.EventHandler,$(window).resize(function(){o.delay(function(){i.ScreenResizeEvent()},250)})}e.prototype.ForceResizeCheck=function(){this.ScreenResizeEvent()},e.prototype.UpdateGameCanvas=function(){this._gameCanvas.attr("width",this.Viewport.Width),this._gameCanvas.attr("height",this.Viewport.Height),this._popUpHolder&&(this._popUpHolder.css("width",this.Viewport.Width),this._popUpHolder.css("height",this.Viewport.Height))},e.prototype.UpdateScreen=function(){this.Viewport=this.UpdateViewport(),this.UpdateGameCanvas(),this.SendNewViewportToServer(),this.OnResize.Trigger(this.Viewport)},e.prototype.ScreenResizeEvent=function(){var e=this;this.UpdateScreen(),setTimeout(function(){e.UpdateScreen(),e.OnResizeComplete.Trigger()},1500)},e.prototype.UpdateViewport=function(){},e.prototype.SendNewViewportToServer=function(){},e.MAX_SCREEN_WIDTH=1e4,e.MAX_SCREEN_HEIGHT=1e4,e.MIN_SCREEN_WIDTH=-1,e.MIN_SCREEN_HEIGHT=-1,e.SCREEN_BUFFER_AREA=200,o.GameScreen=e}(Wanted=Wanted||{}),$(function(){var e=(new signalR.HubConnectionBuilder).configureLogging(signalR.LogLevel.Debug).withUrl("http://localhost:5008/hub",{skipNegotiation:!0,transport:signalR.HttpTransportType.WebSockets}).build(),t=$("#game"),n=$("#popUpHolder"),i=$("#gameContent"),o=$("#loadContent"),r=new Wanted.Server.ServerAdapter(e,"wanted.state");gameScreen=new Wanted.GameScreen(t,n,r),console.log("SERVER ADAPTER",r),r.Negotiate().done(function(e){o.hide(),i.show(),game=new Wanted.Game(t[0],gameScreen,r,e),gameScreen.ForceResizeCheck()})}),!function(e){!function(i){function o(e,t,n){this._debugMode="true"===this.GetUrlVars()[o.DEBUG_FLAG],this._debugMode&&(this._gameInformer=new i.GameInformer(t.Scene),this._updateRate=new i.UpdateRate(this._gameInformer,t),this._drawRate=new i.DrawRate(this._gameInformer),this._payloadRate=new i.PayloadRate(this._gameInformer),this._connectionMonitor=new i.ConnectionMonitor(this._gameInformer,n))}o.prototype.LoadPayload=function(e){this._debugMode&&this._payloadRate.LoadPayload(e)},o.prototype.Update=function(e){this._debugMode&&(this._updateRate.Update(e),this._drawRate.Update(e),this._payloadRate.Update(e),this._gameInformer.Update(e))},o.prototype.Draw=function(e){this._debugMode&&this._drawRate.Draw(e)},o.prototype.GetUrlVars=function(){for(var e,t=[],n=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),i=0;i<n.length;i++)e=n[i].split("="),t.push(e[0]),t[e[0]]=e[1];return t},o.DEBUG_FLAG="debug",i.DebugManager=o}(e.Debug||(e.Debug={}));e.Debug}(Wanted=Wanted||{}),!function(t){t.ConfigurationManager=function(e){console.log(e),t.GameScreen.MAX_SCREEN_HEIGHT=e.ScreenConfig.MAX_SCREEN_HEIGHT,t.GameScreen.MAX_SCREEN_WIDTH=e.ScreenConfig.MAX_SCREEN_WIDTH,t.GameScreen.MIN_SCREEN_HEIGHT=e.ScreenConfig.MIN_SCREEN_HEIGHT,t.GameScreen.MIN_SCREEN_WIDTH=e.ScreenConfig.MIN_SCREEN_WIDTH,t.GameScreen.SCREEN_BUFFER_AREA=e.ScreenConfig.SCREEN_BUFFER_AREA,t.LeaderboardManager.LEADERBOARD_SIZE=e.LeaderboardConfig.LEADERBOARD_SIZE,$.extend(this,e),t.LatencyResolver.REQUEST_PING_EVERY=e.GameConfig.REQUEST_PING_EVERY}}(Wanted=Wanted||{}),!function(e){!function(e){function t(e){this.PayloadContract=e.PayloadContract,this.CursorContract=e.CursorContract,this.LeaderboardEntryContract=e.LeaderboardEntryContract}t.prototype.DecompressCursor=function(e){return{PositionX:e[this.CursorContract.PositionX],PositionY:e[this.CursorContract.PositionY],Name:e[this.CursorContract.Name],Wins:e[this.CursorContract.Wins],Id:e[this.CursorContract.Id],Disposed:!!e[this.CursorContract.Disposed]}},t.prototype.DecompressLeaderboardEntry=function(e){return{Name:e[this.LeaderboardEntryContract.name],Id:e[this.LeaderboardEntryContract.id],Wins:e[this.LeaderboardEntryContract.wins],Position:0}},t.prototype.DecompressPayload=function(e){return{Cursors:e[this.PayloadContract.cursors],LeaderboardPosition:e[this.PayloadContract.leaderboardPosition],CursorsInWorld:e[this.PayloadContract.cursorsInWorld],Notification:e[this.PayloadContract.notification],LastCommandProcessed:e[this.PayloadContract.lastCommandProcessed]}},t.prototype.DecompressLeaderboard=function(e){for(var t=[],n=0;n<e.length;n++){var i=this.DecompressLeaderboardEntry(e[n]);i.position=n+1,t.push(i)}return t},t.prototype.Decompress=function(e){for(var t=this.DecompressPayload(e),n=0,n=0;n<t.Cursors.length;n++)t.Cursors[n]=this.DecompressCursor(t.Cursors[n]);return t},e.PayloadDecompressor=t}(e.Server||(e.Server={}));e.Server}(Wanted=Wanted||{}),!function(e){!function(o){function r(e,t){var n=this,i=(this.Connection=e,this.Proxy=Proxy,this.Proxy.invoke);this.OnPayload=new eg.EventHandler1,this.OnLeaderboardUpdate=new eg.EventHandler1,this.OnForcedDisconnct=new eg.EventHandler,this.OnControlTransferred=new eg.EventHandler,this.OnPingRequest=new eg.EventHandler,this.OnMapResize=new eg.EventHandler1,this.OnMessageReceived=new eg.EventHandler1,this._connectionManager=new o.ServerConnectionManager(t),this.Proxy.invoke=function(){if(n.Connection.state===$.signalR.connectionState.connected)return i.apply(n.Proxy,arguments)}}r.prototype.Negotiate=function(){var n=this,i=(this._connectionManager.PrepareRegistration(),$.Deferred());return this.Wire(),this.Connection.start().then(function(){var t=n._connectionManager.PrepareRegistration();n.TryInitialize(t,function(e){e.UserInformation=t,console.log(e),n._payloadDecompressor=new o.PayloadDecompressor(e.CompressionContracts),i.resolve(e),n.Connection.invoke("readyForPayloads")})}),i.promise()},r.prototype.Stop=function(){this.Connection.stop()},r.prototype.TryInitialize=function(t,n,i){void 0===i&&(i=0);var o=this;this.Connection.invoke("initializeClient",t.RegistrationId).then(function(e){e?n(e):r.NEGOTIATE_RETRIES<=i?(console.log("Could not negotiate with server, refreshing the page."),window.location.reload()):setTimeout(function(){o.TryInitialize(t,n,i+1)},r.RETRY_DELAY)})},r.prototype.Wire=function(){var t=this;this.Connection.on("d",function(e){t._payloadDecompressor.Decompress(e)}),this.Connection.on("l",function(e){t._payloadDecompressor.DecompressLeaderboard(e)}),this.Connection.on("disconnect",function(){}),this.Connection.on("controlTransferred",function(){}),this.Connection.on("pingBack",function(){}),this.Connection.on("mapSizeIncreased",function(e){}),this.Connection.on("chatMessage",function(e,t,n){})},r.NEGOTIATE_RETRIES=3,r.RETRY_DELAY=1,o.ServerAdapter=r}(e.Server||(e.Server={}));e.Server}(Wanted=Wanted||{}),!function(e){!function(e){function t(e){this._authCookieName=e}t.prototype.PrepareRegistration=function(){var e=$.cookie(this._authCookieName),e=e?JSON.parse(e):{},t=e.RegistrationId;if(t)return delete e.RegistrationId,$.cookie(this._authCookieName,JSON.stringify(e),{path:"/",expires:30}),{Name:e.DisplayName,RegistrationId:t};throw new Error("Registration Id not available.")},e.ServerConnectionManager=t}(e.Server||(e.Server={}));e.Server}(Wanted=Wanted||{}),EndGate);!function(r){function n(e,t,n,i){var o=this;this.ControlledCursorId=e,this._cursorManager=t,this._connection=i.Connection,this._proxy=i.Proxy,this._lastSync=new Date,this.LatencyResolver=new r.LatencyResolver(i),this._cursorInputController=new r.CursorInputController(n.Keyboard,function(e,t){var n=o._cursorManager.GetCursor(o.ControlledCursorId);n&&n.MovementController.Controllable&&n.LifeController.Alive&&(t?"Boost"===e?(o.Invoke("registerAbilityStart",o.LatencyResolver.TryRequestPing(),o.NewAbilityCommand(e,!0)),n.AbilityHandler.Activate(e)):n.MovementController.IsMovingInDirection(e)||(o.Invoke("registerMoveStart",o.LatencyResolver.TryRequestPing(),o.NewMovementCommand(e,!0)),n.MovementController.Move(e,t)):n.MovementController.IsMovingInDirection(e)&&(o.Invoke("registerMoveStop",o.LatencyResolver.TryRequestPing(),o.NewMovementCommand(e,!1)),n.MovementController.Move(e,t)))},function(e){e=e.substr(0,1).toUpperCase()+e.substring(1);o._connection.invoke(e)})}n.prototype.LoadPayload=function(e){var t=this._cursorManager.GetCursor(this.ControlledCursorId);t&&t.LevelManager.UpdateExperience(e.Experience,e.ExperienceToNextLevel)},n.prototype.Update=function(e){var t=this._cursorManager.GetCursor(this.ControlledCursorId);t&&(eg.TimeSpan.DateSpan(this._lastSync,e.Now).Seconds>n.SYNC_INTERVAL.Seconds&&t.LifeController.Alive&&(this._lastSync=e.Now,this._connection.invoke("syncMovement",{X:Math.round(t.MovementController.Position.X-t.Graphic.Size.HalfWidth),Y:Math.round(t.MovementController.Position.Y-t.Graphic.Size.HalfHeight)},Math.roundTo(57.2957795*t.MovementController.Rotation,2),{X:Math.round(t.MovementController.Velocity.X),Y:Math.round(t.MovementController.Velocity.Y)})),this._userCameraController.Update(e))},n.prototype.Invoke=function(e,t,n){var i=this._cursorManager.GetCursor(this.ControlledCursorId);this._connection.invoke(e,n.Command,{X:Math.round(i.MovementController.Position.X-i.Graphic.Size.HalfWidth),Y:Math.round(i.MovementController.Position.Y-i.Graphic.Size.HalfHeight)},Math.roundTo(57.2957795*i.MovementController.Rotation,2),{X:Math.round(i.MovementController.Velocity.X),Y:Math.round(i.MovementController.Velocity.Y)},t)},n.prototype.NewMovementCommand=function(e,t){return{Command:e,Start:t,IsAbility:!1}},n.prototype.NewAbilityCommand=function(e,t){return{Command:e,Start:t,IsAbility:!0}},n.SYNC_INTERVAL=eg.TimeSpan.FromSeconds(1.5),r.UserCursorManager=n}(Wanted=Wanted||{}),function(i){function e(e,t,n){this._keyboard=e,this._onMove=t,this._onClick=n,this.BindKeys(["space"],"OnCommandDown","Action",!0),this.BindKeys(["space"],"OnCommandUp","Action",!1),this._clickController=new i.CursorClickController(this._keyboard,this._onClick)}e.prototype.BindKeys=function(e,t,n,i){for(var o=this,r=0;r<e.length;r++)this._keyboard[t](e[r],function(){o._directions[n]!==i&&(o._directions[n]=i,o._onMove(n,i))})},e.DOUBLE_TAP_AFTER=eg.TimeSpan.FromMilliseconds(350),i.CursorInputController=e}(Wanted=Wanted||{}),function(o){function e(e,t,n,i){this._viewport=e,this._scene=t,this._contentManager=i,this._cursors={}}e.prototype.Initialize=function(e){this.UserCursorManager=e},e.prototype.UpdateViewport=function(e){this._viewport.Size=e},e.prototype.GetCursor=function(e){return this._cursors[e]},e.prototype.RemoveCursor=function(e){delete this._cursors[e]},e.prototype.LoadPayload=function(e){for(var t,n=e.Cursors,i=0;i<n.length;i++)t=n[i],this._cursors[t.Id]?this._cursors[t.Id].LoadPayload(t):(t.Id===this.UserCursorManager.ControlledCursorId?t.UserControlled=!0:t.UserControlled=!1,this._cursors[t.Id]=new o.Cursor(t,this._contentManager),this._scene.Add(this._cursors[t.Id].Graphic));this.UserCursorManager.LoadPayload(e)},e.prototype.Update=function(e){for(var t in this._cursors)this._cursors[t].Update(e);for(var t in this.UserCursorManager.Update(e),this._cursors)this._cursors[t].Bounds.IntersectsRectangle(this._viewport)||this._cursors[t].Destroy()},o.CursorManager=e}(Wanted=Wanted||{}),function(e){function t(e){this._userCursorManager=e,this._latency=$("#latency"),this._cursorsInWorld=$("#cursorsInWorld")}t.prototype.LoadPayload=function(e){this._latency[0].innerHTML=this._userCursorManager.LatencyResolver.Latency,this._cursorsInWorld[0].innerHTML=e.CursorsInWorld.toString()},t.prototype.Update=function(e){this._area[0].innerHTML=this._areaRenderer.AreaFromPosition(e.MovementController.Position).toString()},e.EnvironmentMonitor=t}(Wanted=Wanted||{}),function(e){function t(e,t,n,i,o){this._cursorManager=t,this._gameHUD=$("#gameHUD"),this._doublePopupHolder=$("#doublePopupHolder"),this._locationStats=$("#LocationStatisticsHolder"),this._cursorStats=$("#StatisticHolder"),this._logout=$("#logout"),this._myCursorId=e.CursorId,this._logout.click(function(){for(var e=document.cookie.split(";"),t=0;t<e.length;t++){var n=e[t].indexOf("="),n=-1<n?e[t].substr(0,n):e[t];document.cookie=n+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT"}window.location.reload(!0)})}t.prototype.OnScreenResize=function(e){this._gameHUD.css("width",e.Width),this._gameHUD.css("height",this._gameHUDHeight),this._gameHUD.css("top",e.Height),this._cursorHealthMonitor.OnScreenResize(),this.CenterDoublePopup(e),e.Width<=1370?this._locationStats.css("display","none"):this._locationStats.css("display","block"),e.Width<=1177?this._cursorStats.css("display","none"):this._cursorStats.css("display","block")},t.prototype.CenterDoublePopup=function(e){this._doublePopupHolder.css("top",e.Height/2-this._doublePopupHolder.height()/2)},t.prototype.LoadPayload=function(e){this._rankingsManager.LoadPayload(e),this._environmentMonitor.LoadPayload(e),this._deathScreen.LoadPayload(e),this._notificationManager.LoadPayload(e)},t.prototype.Update=function(e){var t=this._cursorManager.GetCursor(this._myCursorId);t&&(this._cursorStatMonitor.Update(t),this._environmentMonitor.Update(t),this._rankingsManager.Update(t))},e.HUDManager=t}(Wanted=Wanted||{}),function(e){function i(e,t,n){var i=this;this._myCursorId=e,this._keyboard=t,this._serverAdapter=n,this._leaderboardHolder=$("#leaderboardHolder, #doublePopupHolder"),this._leaderboard=$("#leaderboard"),this._popUpHolder=$("#popUpHolder"),this._gameCover=$("#GameCover"),this._myRanking=$("#myRanking"),this._leaderboardRows=[],this.LeaderboardUp=!1,this.initializeLeaderboardRows(),this.applyKeyboardShortcuts(),this._serverAdapter.OnLeaderboardUpdate.Bind(function(e){i.bindToLeaderboard(e)})}i.prototype.initializeLeaderboardRows=function(){var e=$("#leaderboard .row");this._leaderboardRows.push(e);for(var t=0;t<i.LEADERBOARD_SIZE-1;t++){var n=e.clone();this._leaderboardRows.push(n),this._leaderboard.append(n)}},i.prototype.bindToLeaderboard=function(e){for(var t=0;t<e.length;t++){var n,i=$(this._leaderboardRows[t]);for(n in e[t].Id===this._myCursorId?i.addClass("highlight"):i.removeClass("highlight"),delete e[t].Id,e[t])i.find(".lb"+n).html(e[t][n])}},i.prototype.applyKeyboardShortcuts=function(){var e=this;this._keyboard.OnCommandPress("l",function(){e.toggleLeaderboard()}),$("#GlobalRanking").click(function(){e.toggleLeaderboard()})},i.prototype.toggleLeaderboard=function(){this.LeaderboardUp?this.hideLeaderboard():this.showLeaderboard()},i.prototype.showLeaderboard=function(){this._leaderboard.hasClass("goLeft")||(this.LeaderboardUp=!0,this._leaderboardHolder.css("display","block"),this._popUpHolder.fadeIn(350),this._gameCover.fadeIn(350),this._serverAdapter.Connection.invoke("readyForLeaderboardPayloads"))},i.prototype.hideLeaderboard=function(){var e=this;this._leaderboard.hasClass("goLeft")||(this.LeaderboardUp=!1,this._popUpHolder.fadeOut(200,function(){e._leaderboardHolder.css("display","none")}),this._gameCover.fadeOut(200),this._serverAdapter.Connection.invoke("stopLeaderboardPayloads"))},e.LeaderboardManager=i}(Wanted=Wanted||{});